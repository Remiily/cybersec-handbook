<!DOCTYPE html>
<html lang="es" x-data="app" x-init="init()" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Hardening - CyberSec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>tailwind.config = { darkMode: 'class' }</script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <header class="sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-4">
                    <button @click="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden sidebar-toggle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <a href="../../index.html" class="flex items-center gap-2">
                        <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">üõ°Ô∏è CyberSec Handbook</h1>
                    </a>
                </div>
                <button @click="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg x-show="!darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                    <svg x-show="darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    <div x-show="sidebarOpen" @click="closeSidebar()" class="sidebar-overlay" x-cloak></div>
    <div class="flex relative">
                        <aside :class="sidebarOpen ? 'open' : ''" class="sidebar">
            <nav class="p-4 space-y-2">
                <!-- Navigation will be generated by navigation.js -->
            </nav>
        </aside>
        <main class="flex-1 min-h-screen lg:ml-64">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <article>
                    <header class="mb-8">
                        <h1 class="text-4xl font-bold mb-4">Hardening de Windows</h1>
                        <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">Gu√≠a paso a paso para endurecer sistemas Windows Server y Windows 10/11</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="badge badge-intermediate">Nivel: Intermedio</span>
                            <span class="badge">ü™ü Windows Server 2022 / Windows 11</span>
                        </div>
                    </header>
                    <div id="table-of-contents" class="toc"></div>
                    <div class="prose prose-lg dark:prose-invert max-w-none">
                        <h2 id="configuracion-inicial">Configuraci√≥n Inicial</h2>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Verificar versi√≥n y build\nsysteminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\n\n# Verificar actualizaciones\nGet-WindowsUpdate\n\n# Instalar todas las actualizaciones cr√≠ticas\nInstall-WindowsUpdate -AcceptAll -AutoReboot\n\n# Verificar estado de servicios cr√≠ticos\nGet-Service | Where-Object {$_.Status -ne \"Running\"} | Select-Object Name, Status, StartType')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar versi√≥n y build
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"

# Verificar actualizaciones
Get-WindowsUpdate

# Instalar todas las actualizaciones cr√≠ticas
Install-WindowsUpdate -AcceptAll -AutoReboot

# Verificar estado de servicios cr√≠ticos
Get-Service | Where-Object {$_.Status -ne "Running"} | Select-Object Name, Status, StartType</code></pre>
                        </div>

                        <h2 id="pol√≠ticas-grupo">Pol√≠ticas de Grupo (GPO)</h2>
                        <h3>Configuraciones de Seguridad Recomendadas</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Abrir Editor de Pol√≠ticas de Grupo\ngpedit.msc\n\n# O desde PowerShell para Server:\n# Abrir GPMC (Group Policy Management Console)\n\n# Pol√≠ticas importantes a configurar:\n# - Pol√≠ticas de Contrase√±as\n# - Pol√≠ticas de Cuentas (Account Lockout)\n# - Pol√≠ticas de Auditor√≠a\n# - Pol√≠ticas de Firewall\n# - Pol√≠ticas de UAC\n\n# Aplicar pol√≠ticas desde PowerShell:\ngpupdate /force')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Abrir Editor de Pol√≠ticas de Grupo
gpedit.msc

# O desde PowerShell para Server:
# Abrir GPMC (Group Policy Management Console)

# Pol√≠ticas importantes a configurar:
# - Pol√≠ticas de Contrase√±as
# - Pol√≠ticas de Cuentas (Account Lockout)
# - Pol√≠ticas de Auditor√≠a
# - Pol√≠ticas de Firewall
# - Pol√≠ticas de UAC

# Aplicar pol√≠ticas desde PowerShell:
gpupdate /force</code></pre>
                        </div>

                        <h2 id="firewall-windows">Firewall de Windows</h2>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Verificar estado del firewall\nGet-NetFirewallProfile | Select-Object Name, Enabled\n\n# Habilitar firewall para todos los perfiles\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled True\n\n# Ver reglas de firewall\nGet-NetFirewallRule | Where-Object {$_.Enabled -eq $true} | Select-Object DisplayName, Direction, Action\n\n# Crear regla para permitir puerto\nNew-NetFirewallRule -DisplayName \"Permit HTTP\" -Direction Inbound -Protocol TCP -LocalPort 80 -Action Allow\n\n# Bloquear IP espec√≠fica\nNew-NetFirewallRule -DisplayName \"Block IP\" -Direction Inbound -RemoteAddress 192.168.1.100 -Action Block')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar estado del firewall
Get-NetFirewallProfile | Select-Object Name, Enabled

# Habilitar firewall para todos los perfiles
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True

# Ver reglas de firewall
Get-NetFirewallRule | Where-Object {$_.Enabled -eq $true} | Select-Object DisplayName, Direction, Action

# Crear regla para permitir puerto
New-NetFirewallRule -DisplayName "Permit HTTP" -Direction Inbound -Protocol TCP -LocalPort 80 -Action Allow

# Bloquear IP espec√≠fica
New-NetFirewallRule -DisplayName "Block IP" -Direction Inbound -RemoteAddress 192.168.1.100 -Action Block</code></pre>
                        </div>

                        <h2 id="bitlocker">BitLocker (Cifrado de Disco)</h2>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Verificar estado de BitLocker\nManage-bde -status\n\n# Habilitar BitLocker (requiere TPM o USB)\nEnable-BitLocker -MountPoint \"C:\" -EncryptionMethod XtsAes256 -UsedSpaceOnly -SkipHardwareTest\n\n# Habilitar con protector de contrase√±a\nEnable-BitLocker -MountPoint \"C:\" -EncryptionMethod XtsAes256 -PasswordProtector -Password (ConvertTo-SecureString \"Contrase√±aSegura\" -AsPlainText -Force)\n\n# Ver claves de recuperaci√≥n\nManage-bde -protectors -get C:\n\n# Suspender BitLocker temporalmente\nSuspend-BitLocker -MountPoint \"C:\" -RebootCount 1')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar estado de BitLocker
Manage-bde -status

# Habilitar BitLocker (requiere TPM o USB)
Enable-BitLocker -MountPoint "C:" -EncryptionMethod XtsAes256 -UsedSpaceOnly -SkipHardwareTest

# Habilitar con protector de contrase√±a
Enable-BitLocker -MountPoint "C:" -EncryptionMethod XtsAes256 -PasswordProtector -Password (ConvertTo-SecureString "Contrase√±aSegura" -AsPlainText -Force)

# Ver claves de recuperaci√≥n
Manage-bde -protectors -get C:

# Suspender BitLocker temporalmente
Suspend-BitLocker -MountPoint "C:" -RebootCount 1</code></pre>
                        </div>

                        <h2 id="usuarios-permisos">Usuarios y Permisos</h2>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Listar usuarios locales\nGet-LocalUser\n\n# Crear usuario local\nNew-LocalUser -Name \"nuevo_usuario\" -Password (ConvertTo-SecureString \"Contrase√±aSegura123!\" -AsPlainText -Force) -Description \"Usuario de prueba\"\n\n# Agregar usuario a grupo\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"nuevo_usuario\"\n\n# Deshabilitar cuenta\nDisable-LocalUser -Name \"usuario\"\n\n# Eliminar usuario\nRemove-LocalUser -Name \"usuario\"\n\n# Ver grupos locales\nGet-LocalGroup\n\n# Ver miembros de grupo\nGet-LocalGroupMember -Group \"Administrators\"')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Listar usuarios locales
Get-LocalUser

# Crear usuario local
New-LocalUser -Name "nuevo_usuario" -Password (ConvertTo-SecureString "Contrase√±aSegura123!" -AsPlainText -Force) -Description "Usuario de prueba"

# Agregar usuario a grupo
Add-LocalGroupMember -Group "Administrators" -Member "nuevo_usuario"

# Deshabilitar cuenta
Disable-LocalUser -Name "usuario"

# Eliminar usuario
Remove-LocalUser -Name "usuario"

# Ver grupos locales
Get-LocalGroup

# Ver miembros de grupo
Get-LocalGroupMember -Group "Administrators"</code></pre>
                        </div>

                        <h2 id="auditoria">Auditor√≠a y Logs</h2>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Ver eventos de seguridad\nGet-EventLog -LogName Security -Newest 50\n\n# Ver eventos de sistema\nGet-EventLog -LogName System -Newest 50\n\n# Filtrar eventos de login\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} | Select-Object TimeCreated, Message\n\n# Filtrar eventos de fallos de login\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | Select-Object TimeCreated, Message\n\n# Habilitar auditor√≠a de pol√≠ticas (desde GPO)\n# Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Audit Policy')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Ver eventos de seguridad
Get-EventLog -LogName Security -Newest 50

# Ver eventos de sistema
Get-EventLog -LogName System -Newest 50

# Filtrar eventos de login
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} | Select-Object TimeCreated, Message

# Filtrar eventos de fallos de login
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | Select-Object TimeCreated, Message

# Habilitar auditor√≠a de pol√≠ticas (desde GPO)
# Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Audit Policy</code></pre>
                        </div>

                        <h2 id="checklist-windows">Checklist de Hardening Windows</h2>
                        <div class="checklist-container bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-6" data-checklist-id="windows-hardening">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-semibold">Verificaci√≥n de Hardening</h3>
                                <div class="flex gap-2">
                                    <button onclick="resetChecklist(this.closest('.checklist-container'))" class="text-sm px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600">Resetear</button>
                                    <button onclick="exportChecklist(this.closest('.checklist-container'))" class="text-sm px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">Exportar</button>
                                </div>
                            </div>
                            <div class="progress-bar mb-4">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 progress-text">0/12 completado (0%)</p>
                            <div class="space-y-2">
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Actualizaciones instaladas y autom√°ticas habilitadas</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Firewall de Windows habilitado para todos los perfiles</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>UAC habilitado (nivel recomendado o superior)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Pol√≠ticas de contrase√±as configuradas (complejidad, longitud m√≠nima)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Account lockout policy configurada</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>BitLocker habilitado (si aplica)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Servicios innecesarios deshabilitados</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Pol√≠ticas de auditor√≠a configuradas</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Cuentas de invitado deshabilitadas</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>RDP configurado de forma segura (NLA habilitado)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Windows Defender habilitado y actualizado</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Shares de red configurados con permisos m√≠nimos</span>
                                </label>
                            </div>
                        </div>

                        <h2 id="migracion-versiones-windows">Migraci√≥n y Actualizaci√≥n de Versiones Windows</h2>
                        <p>Windows Server se actualiza cada 2-3 a√±os. Migrar de una versi√≥n a otra (ej: Server 2019 ‚Üí 2022) requiere planificaci√≥n cuidadosa para mantener la seguridad y funcionalidad.</p>

                        <h3 id="preparacion-migracion-windows">Preparaci√≥n para Migraci√≥n</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy("# Verificar versi√≥n actual\nsysteminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\nGet-ComputerInfo | Select-Object WindowsProductName, WindowsVersion\n\n# Verificar espacio en disco (necesario ~32GB libre)\nGet-PSDrive C | Select-Object Used, Free\n\n# Verificar roles y caracter√≠sticas instaladas\nGet-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}\n\n# Crear backup completo del sistema\n# Usar Windows Server Backup o herramienta de terceros\nwbadmin start backup -backupTarget:E: -include:C: -allCritical -quiet\n\n# Backup de Active Directory (si aplica)\n# ntdsutil \"activate instance ntds\" \"ifm\" \"create full C:\\backup\\ntds\" quit quit\n\n# Backup de bases de datos\n# SQL Server: Backup-SqlDatabase -ServerInstance . -Database DBName -BackupFile C:\\backup\\DB.bak\n\n# Exportar GPOs\nBackup-Gpo -All -Path C:\\backup\\GPOs\n\n# Documentar configuraciones\nGet-NetFirewallProfile | Export-Csv C:\\backup\\firewall.csv\nGet-Service | Export-Csv C:\\backup\\services.csv")" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar versi√≥n actual
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion

# Verificar espacio en disco (necesario ~32GB libre)
Get-PSDrive C | Select-Object Used, Free

# Verificar roles y caracter√≠sticas instaladas
Get-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}

# Crear backup completo del sistema
# Usar Windows Server Backup o herramienta de terceros
wbadmin start backup -backupTarget:E: -include:C: -allCritical -quiet

# Backup de Active Directory (si aplica)
# ntdsutil "activate instance ntds" "ifm" "create full C:\backup\ntds" quit quit

# Backup de bases de datos
# SQL Server: Backup-SqlDatabase -ServerInstance . -Database DBName -BackupFile C:\backup\DB.bak

# Exportar GPOs
Backup-Gpo -All -Path C:\backup\GPOs

# Documentar configuraciones
Get-NetFirewallProfile | Export-Csv C:\backup\firewall.csv
Get-Service | Export-Csv C:\backup\services.csv</code></pre>
                        </div>

                        <h3 id="migracion-windows-server">Migraci√≥n de Windows Server (Ejemplo: 2019 ‚Üí 2022)</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy("# M√©todo 1: In-Place Upgrade (recomendado para servidores simples)\n# Verificar compatibilidad\n# Ejecutar Windows Server Migration Tools\n\n# Descargar ISO de Windows Server 2022\n# Montar ISO y ejecutar setup.exe\n\n# Durante la instalaci√≥n:\n# - Seleccionar 'Upgrade: Install Windows and keep files, settings, and applications'\n# - Seguir wizard de instalaci√≥n\n# - Resolver conflictos de compatibilidad\n\n# M√©todo 2: Migraci√≥n limpia (recomendado para producci√≥n)\n# 1. Instalar nuevo servidor con Windows Server 2022\n# 2. Migrar roles y caracter√≠sticas\n# 3. Migrar aplicaciones y datos\n# 4. Actualizar DNS y configuraciones de red\n# 5. Descomisionar servidor antiguo\n\n# Migrar roles espec√≠ficos:\n# - AD DS: Usar Active Directory Migration Tool (ADMT)\n# - DNS: Migrar zonas DNS\n# - DHCP: Exportar/importar configuraci√≥n\n# - File Services: Migrar shares y permisos\n\n# Verificar actualizaci√≥n\nGet-ComputerInfo | Select-Object WindowsProductName, WindowsVersion\n\n# Verificar servicios\nGet-Service | Where-Object {$_.Status -ne 'Running'}\n\n# Verificar roles\nGet-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}")" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># M√©todo 1: In-Place Upgrade (recomendado para servidores simples)
# Verificar compatibilidad
# Ejecutar Windows Server Migration Tools

# Descargar ISO de Windows Server 2022
# Montar ISO y ejecutar setup.exe

# Durante la instalaci√≥n:
# - Seleccionar 'Upgrade: Install Windows and keep files, settings, and applications'
# - Seguir wizard de instalaci√≥n
# - Resolver conflictos de compatibilidad

# M√©todo 2: Migraci√≥n limpia (recomendado para producci√≥n)
# 1. Instalar nuevo servidor con Windows Server 2022
# 2. Migrar roles y caracter√≠sticas
# 3. Migrar aplicaciones y datos
# 4. Actualizar DNS y configuraciones de red
# 5. Descomisionar servidor antiguo

# Migrar roles espec√≠ficos:
# - AD DS: Usar Active Directory Migration Tool (ADMT)
# - DNS: Migrar zonas DNS
# - DHCP: Exportar/importar configuraci√≥n
# - File Services: Migrar shares y permisos

# Verificar actualizaci√≥n
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion

# Verificar servicios
Get-Service | Where-Object {$_.Status -ne 'Running'}

# Verificar roles
Get-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed'}</code></pre>
                        </div>

                        <h3 id="post-migracion-windows">Post-Migraci√≥n</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy("# Verificar versi√≥n nueva\nGet-ComputerInfo | Select-Object WindowsProductName, WindowsVersion\n\n# Verificar servicios fallidos\nGet-Service | Where-Object {$_.Status -eq 'Stopped'}\n\n# Verificar eventos de error\nGet-EventLog -LogName System -EntryType Error -Newest 20\nGet-EventLog -LogName Application -EntryType Error -Newest 20\n\n# Verificar aplicaciones instaladas\nGet-WmiObject -Class Win32_Product | Select-Object Name, Version\n\n# Reaplicar hardening\n# - Revisar GPOs\n# - Verificar firewall\n# - Verificar servicios\n# - Reaplicar benchmarks CIS\n\n# Verificar conectividad de red\nTest-NetConnection -ComputerName servidor -Port 80\n\n# Verificar Active Directory (si aplica)\ndcdiag /test:dcpromo\ndcdiag /test:replications")" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar versi√≥n nueva
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion

# Verificar servicios fallidos
Get-Service | Where-Object {$_.Status -eq 'Stopped'}

# Verificar eventos de error
Get-EventLog -LogName System -EntryType Error -Newest 20
Get-EventLog -LogName Application -EntryType Error -Newest 20

# Verificar aplicaciones instaladas
Get-WmiObject -Class Win32_Product | Select-Object Name, Version

# Reaplicar hardening
# - Revisar GPOs
# - Verificar firewall
# - Verificar servicios
# - Reaplicar benchmarks CIS

# Verificar conectividad de red
Test-NetConnection -ComputerName servidor -Port 80

# Verificar Active Directory (si aplica)
dcdiag /test:dcpromo
dcdiag /test:replications</code></pre>
                        </div>

                        <div class="alert alert-warning mb-6">
                            <p class="font-semibold mb-2">‚ö†Ô∏è Consideraciones Importantes</p>
                            <ul class="list-disc list-inside">
                                <li><strong>Backup completo:</strong> Siempre haz backup antes de migrar, incluyendo System State</li>
                                <li><strong>Compatibilidad:</strong> Verifica compatibilidad de aplicaciones y drivers</li>
                                <li><strong>Active Directory:</strong> Para AD, considera migraci√≥n limpia en lugar de in-place upgrade</li>
                                <li><strong>Ventana de mantenimiento:</strong> Planifica tiempo suficiente (4-8 horas)</li>
                                <li><strong>Rollback plan:</strong> Ten un plan de rollback documentado y probado</li>
                                <li><strong>Hardening post-migraci√≥n:</strong> Reaplica todas las configuraciones de seguridad</li>
                            </ul>
                        </div>

                        <div class="alert alert-success mt-8">
                            <p class="font-semibold mb-2">‚úÖ Windows Hardening</p>
                            <p>El hardening de Windows es un proceso continuo. Usa esta gu√≠a como punto de partida y adapta las configuraciones seg√∫n tus necesidades espec√≠ficas. Considera usar Security Compliance Toolkit (SCT) de Microsoft para aplicar benchmarks CIS. Para migraciones, siempre haz backup completo y prueba en entorno no cr√≠tico primero.</p>
                        </div>
                    </div>
                </article>
            </div>
        </main>
    </div>
    <footer class="bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-sm text-gray-600 dark:text-gray-400">¬© 2026 CyberSec Handbook. Todos los derechos reservados.</p>
                <a href="https://github.com/remiily/cybersec-handbook" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">Editar en GitHub</a>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/search.js"></script>
    <script src="../../assets/js/main.js"></script>
    <style>[x-cloak] { display: none !important; }</style>
            <script>
        // Inicializar navegaci√≥n cuando el DOM est√© listo
        (function() {
            function initNav() {
                if (typeof initNavigation === 'function') {
                    initNavigation();
                } else if (typeof generateNavigation === 'function') {
                    const sidebar = document.querySelector('.sidebar nav');
                    if (sidebar) {
                        sidebar.innerHTML = generateNavigation();
                        if (typeof highlightCurrentPage === 'function') {
                            highlightCurrentPage();
                        }
                    }
                }
            }
            
            // Esperar a que todos los scripts est√©n cargados
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(initNav, 200);
                });
            } else {
                // DOM ya est√° listo, pero esperar un poco para asegurar que Alpine.js est√© listo
                setTimeout(initNav, 200);
            }
        })();
    </script>
        <script>
        // Inicializar navegaci√≥n cuando el DOM est√© listo
        (function() {
            function initNav() {
                if (typeof initNavigation === 'function') {
                    initNavigation();
                } else if (typeof generateNavigation === 'function') {
                    const sidebar = document.querySelector('.sidebar nav');
                    if (sidebar) {
                        sidebar.innerHTML = generateNavigation();
                        if (typeof highlightCurrentPage === 'function') {
                            highlightCurrentPage();
                        }
                    }
                }
            }
            
            // Esperar a que todos los scripts est√©n cargados
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(initNav, 200);
                });
            } else {
                // DOM ya est√° listo, pero esperar un poco para asegurar que Alpine.js est√© listo
                setTimeout(initNav, 200);
            }
        })();
    </script>
</body>
</html>
