<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lynis - Herramienta de Hardening - Cybersec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../assets/css/main.css">
</head>
<body class="bg-white dark:bg-slate-900 text-gray-900 dark:text-gray-100">
    <div id="sidebar-overlay" class="sidebar-overlay" onclick="closeSidebar()"></div>
    <aside id="sidebar" class="sidebar fixed top-0 left-0 h-full w-64 bg-white dark:bg-slate-800 border-r border-gray-200 dark:border-gray-700 z-50 overflow-y-auto">
        <div class="p-4">
            <a href="../../" class="text-xl font-bold text-blue-600 dark:text-blue-400 block mb-6">üîí Cybersec Handbook</a>
            <nav>
                <a href="../" class="block px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">‚Üê Volver a Hardening</a>
            </nav>
        </div>
    </aside>
    
    <div class="lg:ml-64">
        <header class="sticky top-0 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between px-4 py-3">
                <button id="sidebar-toggle" onclick="toggleSidebar()" class="lg:hidden mr-3 text-gray-500"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
                <div id="breadcrumbs" class="breadcrumb"></div>
                <button id="theme-toggle" onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button>
            </div>
        </header>
        
        <main class="p-6 max-w-5xl mx-auto">
            <article>
                <header class="mb-8">
                    <h1 class="text-4xl font-bold mb-4">Lynis - Auditor√≠a de Seguridad</h1>
                    <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">
                        Herramienta de auditor√≠a de seguridad de c√≥digo abierto para sistemas Unix/Linux
                    </p>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="badge badge-intermediate">Intermedio</span>
                        <span class="text-sm text-gray-500">‚è±Ô∏è 30 min</span>
                    </div>
                </header>
                
                <div id="table-of-contents" class="toc">
                    <h3 class="font-semibold mb-3">Tabla de Contenidos</h3>
                </div>
                
                <section class="mb-8">
                    <h2 id="que-es-lynis" class="text-2xl font-semibold mb-4">¬øQu√© es Lynis?</h2>
                    <p class="mb-4">
                        <strong>Lynis</strong> es una herramienta de auditor√≠a de seguridad de c√≥digo abierto que 
                        realiza un escaneo completo del sistema para identificar vulnerabilidades y proporcionar 
                        recomendaciones de hardening.
                    </p>
                    <p class="mb-4">
                        Es especialmente √∫til porque no requiere instalaci√≥n de agentes, puede ejecutarse desde 
                        un USB o ejecutarse directamente, y proporciona recomendaciones espec√≠ficas y accionables.
                    </p>
                </section>
                
                <section class="mb-8">
                    <h2 id="instalacion" class="text-2xl font-semibold mb-4">Instalaci√≥n</h2>
                    
                    <h3 class="text-xl font-semibold mb-3">Ubuntu/Debian</h3>
                    <div class="command-block">
                        <pre><code># Instalar desde repositorio
sudo apt update
sudo apt install lynis

# O instalar desde tarball
wget https://downloads.cisofy.com/lynis/lynis-3.0.8.tar.gz
tar -xzf lynis-3.0.8.tar.gz
cd lynis
sudo ./lynis audit system</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">Red Hat/CentOS</h3>
                    <div class="command-block">
                        <pre><code># Instalar EPEL repository primero
sudo yum install epel-release
sudo yum install lynis</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">macOS</h3>
                    <div class="command-block">
                        <pre><code># Con Homebrew
brew install lynis</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="uso-basico" class="text-2xl font-semibold mb-4">Uso B√°sico</h2>
                    
                    <h3 class="text-xl font-semibold mb-3">Auditor√≠a Completa del Sistema</h3>
                    <div class="command-block">
                        <pre><code># Ejecutar auditor√≠a completa (requiere sudo para mejores resultados)
sudo lynis audit system

# Ejecutar sin sudo (limitado)
lynis audit system</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">Auditor√≠a Espec√≠fica</h3>
                    <div class="command-block">
                        <pre><code># Auditar solo una categor√≠a espec√≠fica
sudo lynis audit system --tests-from-group authentication

# Ver categor√≠as disponibles
lynis show profiles
lynis show tests</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="interpretando-resultados" class="text-2xl font-semibold mb-4">Interpretando los Resultados</h2>
                    <p class="mb-4">
                        Lynis proporciona un informe detallado con varios componentes:
                    </p>
                    
                    <h3 class="text-xl font-semibold mb-3">Score de Hardening</h3>
                    <p class="mb-4">
                        Un puntaje de 0-100 que indica qu√© tan "duro" est√° el sistema. Un puntaje m√°s alto 
                        indica un sistema m√°s seguro, pero tambi√©n puede indicar menos funcionalidad.
                    </p>
                    
                    <h3 class="text-xl font-semibold mb-3">Warnings y Suggestions</h3>
                    <ul class="list-disc list-inside space-y-2 mb-4">
                        <li><strong>Warnings:</strong> Problemas que deben abordarse</li>
                        <li><strong>Suggestions:</strong> Mejoras recomendadas</li>
                        <li><strong>Skipped tests:</strong> Pruebas que no se pudieron ejecutar</li>
                    </ul>
                    
                    <h3 class="text-xl font-semibold mb-3">Archivos de Salida</h3>
                    <div class="command-block">
                        <pre><code># Lynis genera varios archivos:
# - /var/log/lynis.log (log detallado)
# - /var/log/lynis-report.dat (datos estructurados)
# - lynis-report.txt (reporte legible en el directorio actual)</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="ejemplo-salida" class="text-2xl font-semibold mb-4">Ejemplo de Salida</h2>
                    <div class="command-block">
                        <pre><code>================================================================================

  Lynis security scan details:

  Hardening index : 68 [#############        ]
  Tests performed : 279
  Plugins enabled : 5

  Components:
  - Firewall               [V]
  - Malware scanner        [X]
  - SSH Support            [V]

================================================================================
  Suggestions (29):
  ----------------------------
  * Set a password on GRUB boot loader to prevent alteration of boot configuration (e.g. /boot/grub/grub.cfg) [KRNL-5830]
     https://cisofy.com/lynis/controls/KRNL-5830/

  * Configure logrotate to rotate the logs properly [LOGG-2152]
     https://cisofy.com/lynis/controls/LOGG-2152/

  * Enable process accounting [ACCT-9622]
     https://cisofy.com/lynis/controls/ACCT-9622/
...</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="mejores-practicas" class="text-2xl font-semibold mb-4">Mejores Pr√°cticas</h2>
                    <ul class="list-disc list-inside space-y-2 mb-4">
                        <li><strong>Ejecutar regularmente:</strong> Programa auditor√≠as peri√≥dicas (mensuales o trimestrales)</li>
                        <li><strong>Comparar resultados:</strong> Compara resultados entre ejecuciones para detectar cambios</li>
                        <li><strong>Revisar todas las sugerencias:</strong> No todas son aplicables, pero revisa cada una</li>
                        <li><strong>Documentar cambios:</strong> Registra qu√© recomendaciones implementaste y por qu√©</li>
                        <li><strong>Usar en CI/CD:</strong> Integra Lynis en pipelines de despliegue para validar configuraciones</li>
                    </ul>
                </section>
                
                <section class="mb-8">
                    <h2 id="automatizacion" class="text-2xl font-semibold mb-4">Automatizaci√≥n</h2>
                    <p class="mb-4">
                        Puedes automatizar las auditor√≠as de Lynis usando cron o scripts:
                    </p>
                    
                    <div class="command-block">
                        <pre><code>#!/bin/bash
# Script de auditor√≠a automatizada

LOG_DIR="/var/log/lynis-reports"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $LOG_DIR

sudo lynis audit system --quiet --no-colors > $LOG_DIR/lynis-report-$DATE.txt

# Enviar por email si hay warnings cr√≠ticos
if grep -q "warning" $LOG_DIR/lynis-report-$DATE.txt; then
    mail -s "Lynis Report - Warnings Found" admin@example.com < $LOG_DIR/lynis-report-$DATE.txt
fi</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="referencias" class="text-2xl font-semibold mb-4">Referencias</h2>
                    <ul class="list-disc list-inside space-y-2">
                        <li><a href="https://cisofy.com/lynis/" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">Sitio Oficial de Lynis</a></li>
                        <li><a href="https://github.com/CISOfy/lynis" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">Repositorio en GitHub</a></li>
                        <li><a href="https://cisofy.com/lynis/controls/" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">Base de Datos de Controles</a></li>
                    </ul>
                </section>
            </article>
        </main>
        
        <footer class="border-t border-gray-200 dark:border-gray-700 mt-12 py-8">
            <div class="max-w-5xl mx-auto px-6">
                <p class="text-sm text-gray-600 dark:text-gray-400 text-center">
                    √öltima actualizaci√≥n: 2025-01-XX | 
                    <a href="https://github.com/your-username/cybersec-handbook" class="text-blue-600 dark:text-blue-400 hover:underline">Editar en GitHub</a>
                </p>
            </div>
        </footer>
    </div>
    
    <script src="../../assets/js/main.js"></script>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
</body>
</html>
