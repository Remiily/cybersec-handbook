<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardening Windows 10/11 - Cybersec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../../assets/css/main.css">
</head>
<body class="bg-white dark:bg-slate-900 text-gray-900 dark:text-gray-100">
    <div id="sidebar-overlay" class="sidebar-overlay" onclick="closeSidebar()"></div>
    <aside id="sidebar" class="sidebar fixed top-0 left-0 h-full w-64 bg-white dark:bg-slate-800 border-r border-gray-200 dark:border-gray-700 z-50 overflow-y-auto">
        <div class="p-4">
            <a href="../../../" class="text-xl font-bold text-blue-600 dark:text-blue-400 block mb-6">üîí Cybersec Handbook</a>
            <nav>
                <a href="../../" class="block px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">‚Üê Volver a Hardening</a>
            </nav>
        </div>
    </aside>
    
    <div class="lg:ml-64">
        <header class="sticky top-0 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between px-4 py-3">
                <button id="sidebar-toggle" onclick="toggleSidebar()" class="lg:hidden mr-3 text-gray-500"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
                <div id="breadcrumbs" class="breadcrumb"></div>
                <button id="theme-toggle" onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button>
            </div>
        </header>
        
        <main class="p-6 max-w-5xl mx-auto">
            <article>
                <header class="mb-8">
                    <h1 class="text-4xl font-bold mb-4">Hardening de Windows 10/11</h1>
                    <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">
                        Gu√≠a completa paso a paso para endurecer sistemas Windows 10 y Windows 11
                    </p>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="badge badge-intermediate">Intermedio</span>
                        <span class="text-sm text-gray-500">‚è±Ô∏è 3-4 horas</span>
                    </div>
                </header>
                
                <div id="table-of-contents" class="toc">
                    <h3 class="font-semibold mb-3">Tabla de Contenidos</h3>
                </div>
                
                <div class="alert alert-warning">
                    <strong>Importante:</strong> Siempre realiza estas configuraciones en un entorno de prueba primero. 
                    Algunos cambios pueden afectar la funcionalidad del sistema. Haz backup antes de comenzar.
                </div>
                
                <section class="mb-8">
                    <h2 id="actualizaciones-windows" class="text-2xl font-semibold mb-4">1. Actualizaciones de Windows</h2>
                    <p class="mb-4">
                        Mantener Windows actualizado es fundamental para la seguridad. Windows Update debe estar configurado correctamente.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Verificar estado de actualizaciones
Get-WindowsUpdate

# Instalar actualizaciones pendientes
Install-WindowsUpdate -AcceptAll -AutoReboot

# Configurar Windows Update para descargar e instalar autom√°ticamente
# Ir a: Configuraci√≥n > Actualizaci√≥n y seguridad > Windows Update
# Activar: "Actualizar autom√°ticamente"</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">Configuraci√≥n mediante Group Policy (GPO)</h3>
                    <p class="mb-4">
                        En entornos empresariales, configura Windows Update mediante GPO:
                    </p>
                    <ul class="list-disc list-inside space-y-2 mb-4">
                        <li><strong>Configurar actualizaciones autom√°ticas:</strong> Computer Configuration > Policies > Administrative Templates > Windows Components > Windows Update</li>
                        <li><strong>Establecer servicio de actualizaci√≥n:</strong> Configurar un WSUS (Windows Server Update Services) interno</li>
                        <li><strong>Programar instalaciones:</strong> Definir ventanas de mantenimiento apropiadas</li>
                    </ul>
                    
                    <div class="mt-4">
                        <strong>¬øPor qu√©?</strong> Los parches de seguridad cierran vulnerabilidades conocidas y cr√≠ticas.
                        <br>
                        <strong>Riesgo mitigado:</strong> Explotaci√≥n de vulnerabilidades conocidas (CVE), ataques dirigidos.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="firewall-windows" class="text-2xl font-semibold mb-4">2. Configuraci√≥n del Firewall de Windows</h2>
                    <p class="mb-4">
                        Windows Firewall debe estar habilitado y configurado correctamente para bloquear tr√°fico no autorizado.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Verificar estado del firewall
Get-NetFirewallProfile | Select-Object Name, Enabled

# Habilitar firewall para todos los perfiles
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True

# Ver reglas de firewall
Get-NetFirewallRule | Where-Object {$_.Enabled -eq $true} | Format-Table -AutoSize

# Crear regla para bloquear puerto espec√≠fico
New-NetFirewallRule -DisplayName "Block Port 12345" -Direction Inbound -LocalPort 12345 -Protocol TCP -Action Block

# Bloquear todo el tr√°fico entrante por defecto (excepto reglas permitidas)
Set-NetFirewallProfile -DefaultInboundAction Block
Set-NetFirewallProfile -DefaultOutboundAction Allow</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">Configuraci√≥n Recomendada</h3>
                    <ul class="list-disc list-inside space-y-2 mb-4">
                        <li><strong>Perfil de dominio:</strong> Menos restrictivo (para redes corporativas confiables)</li>
                        <li><strong>Perfil privado:</strong> Restrictivo (para redes dom√©sticas/privadas)</li>
                        <li><strong>Perfil p√∫blico:</strong> Muy restrictivo (para redes p√∫blicas/WiFi)</li>
                        <li>Solo permitir conexiones salientes por defecto</li>
                        <li>Revisar y eliminar reglas innecesarias regularmente</li>
                    </ul>
                    
                    <div class="mt-4">
                        <strong>¬øPor qu√©?</strong> El firewall es la primera l√≠nea de defensa contra accesos no autorizados.
                        <br>
                        <strong>Riesgo mitigado:</strong> Acceso remoto no autorizado, escaneo de puertos, conexiones maliciosas.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="cuentas-usuarios" class="text-2xl font-semibold mb-4">3. Gesti√≥n de Cuentas de Usuario</h2>
                    
                    <h3 class="text-xl font-semibold mb-3">3.1 Deshabilitar cuenta Administrator</h3>
                    <div class="command-block">
                        <pre><code># PowerShell - Deshabilitar cuenta Administrator
$admin = Get-LocalUser -Name "Administrator"
Disable-LocalUser -Name "Administrator"

# Renombrar cuenta Administrator (buena pr√°ctica)
Rename-LocalUser -Name "Administrator" -NewName "AdminDisabled"

# Crear cuenta administrativa alternativa con nombre no obvio
New-LocalUser -Name "svc-admin" -Password (ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force) -Description "Service Admin Account"
Add-LocalGroupMember -Group "Administrators" -Member "svc-admin"</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">3.2 Control de Acceso de Usuario (UAC)</h3>
                    <p class="mb-4">
                        UAC debe estar habilitado en el nivel m√°s alto posible sin afectar la usabilidad.
                    </p>
                    <div class="command-block">
                        <pre><code># PowerShell - Configurar UAC al m√°ximo nivel
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 1
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 2
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorUser" -Value 1
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">3.3 Pol√≠ticas de Contrase√±as</h3>
                    <div class="command-block">
                        <pre><code># PowerShell - Configurar pol√≠tica de contrase√±as local
net accounts /minpwlen:14
net accounts /maxpwage:90
net accounts /minpwage:1
net accounts /uniquepw:5

# Mediante GPO (recomendado en entornos empresariales):
# Computer Configuration > Policies > Windows Settings > Security Settings > Account Policies > Password Policy
# - Enforce password history: 24 passwords
# - Maximum password age: 90 days
# - Minimum password age: 1 day
# - Minimum password length: 14 characters
# - Password must meet complexity requirements: Enabled</code></pre>
                    </div>
                    
                    <div class="mt-4">
                        <strong>¬øPor qu√©?</strong> Las cuentas con privilegios elevados son objetivos principales de atacantes.
                        <br>
                        <strong>Riesgo mitigado:</strong> Compromiso de cuenta administrativa, escalada de privilegios, acceso no autorizado.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="servicios-windows" class="text-2xl font-semibold mb-4">4. Deshabilitar Servicios Innecesarios</h2>
                    <p class="mb-4">
                        Windows ejecuta muchos servicios por defecto. Deshabilita los que no necesites para reducir la superficie de ataque.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Ver servicios en ejecuci√≥n
Get-Service | Where-Object {$_.Status -eq "Running"} | Format-Table -AutoSize

# Deshabilitar servicios comunes innecesarios
$services = @(
    "RemoteRegistry",
    "Telnet",
    "SNMP",
    "Fax",
    "WSearch"
)

foreach ($service in $services) {
    Stop-Service -Name $service -Force -ErrorAction SilentlyContinue
    Set-Service -Name $service -StartupType Disabled -ErrorAction SilentlyContinue
}

# Servicios que NO debes deshabilitar sin revisar:
# - Windows Update
# - Windows Defender
# - Event Log
# - Plug and Play</code></pre>
                    </div>
                    
                    <div class="alert alert-warning">
                        <strong>Precauci√≥n:</strong> Antes de deshabilitar servicios, investiga su prop√≥sito. 
                        Deshabilitar servicios cr√≠ticos puede romper funcionalidades del sistema.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="windows-defender" class="text-2xl font-semibold mb-4">5. Windows Defender y Protecci√≥n contra Malware</h2>
                    <p class="mb-4">
                        Windows Defender es el antivirus integrado en Windows 10/11. Debe estar habilitado y actualizado.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Verificar estado de Windows Defender
Get-MpComputerStatus

# Habilitar Windows Defender
Set-MpPreference -DisableRealtimeMonitoring $false

# Habilitar protecci√≥n en la nube
Set-MpPreference -MAPSReporting Advanced

# Habilitar protecci√≥n de red
Set-MpPreference -EnableNetworkProtection Enabled

# Configurar exclusiones (solo si es necesario)
Add-MpPreference -ExclusionPath "C:\Program Files\MyApp"

# Ejecutar escaneo completo
Start-MpScan -ScanType FullScan</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-3 mt-4">Windows Defender Application Guard</h3>
                    <p class="mb-4">
                        Para m√°xima protecci√≥n, considera habilitar Windows Defender Application Guard (WDAG):
                    </p>
                    <div class="command-block">
                        <pre><code># Habilitar Windows Defender Application Guard (requiere Windows 10/11 Pro/Enterprise)
Enable-WindowsOptionalFeature -Online -FeatureName Windows-Defender-ApplicationGuard

# Configurar pol√≠ticas de Application Guard mediante GPO
# Computer Configuration > Policies > Administrative Templates > Windows Components > Windows Defender Application Guard</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="bitlocker" class="text-2xl font-semibold mb-4">6. BitLocker (Cifrado de Disco)</h2>
                    <p class="mb-4">
                        BitLocker cifra los vol√∫menes del disco para proteger datos en caso de p√©rdida o robo del dispositivo.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Verificar estado de BitLocker
Get-BitLockerVolume

# Habilitar BitLocker en unidad C: (requiere TPM o clave de inicio)
Enable-BitLocker -MountPoint "C:" -EncryptionMethod XtsAes256 -UsedSpaceOnly -RecoveryPasswordProtector

# Habilitar BitLocker con TPM + PIN (m√°s seguro)
Enable-BitLocker -MountPoint "C:" -EncryptionMethod XtsAes256 -UsedSpaceOnly -TpmAndPinProtector -Pin "12345678"

# Configurar pol√≠ticas de BitLocker mediante GPO
# Computer Configuration > Policies > Administrative Templates > Windows Components > BitLocker Drive Encryption</code></pre>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Nota:</strong> BitLocker requiere Windows 10/11 Pro, Enterprise o Education. 
                        No est√° disponible en versiones Home.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="registro-windows" class="text-2xl font-semibold mb-4">7. Configuraci√≥n del Registro de Windows</h2>
                    <p class="mb-4">
                        Algunas configuraciones de seguridad solo est√°n disponibles mediante el registro de Windows.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Configuraciones de seguridad en el registro

# Deshabilitar ejecuci√≥n autom√°tica de USB/CD
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" -Name "NoDriveTypeAutoRun" -Value 255

# Deshabilitar almacenamiento de contrase√±as LM (hash d√©bil)
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa" -Name "NoLMHash" -Value 1

# Habilitar auditor√≠a de eventos de seguridad
auditpol /set /category:"Logon/Logoff" /success:enable /failure:enable
auditpol /set /category:"Object Access" /success:enable /failure:enable
auditpol /set /category:"Policy Change" /success:enable /failure:enable
auditpol /set /category:"Privilege Use" /success:enable /failure:enable
auditpol /set /category:"System" /success:enable /failure:enable

# Deshabilitar SMBv1 (vulnerable)
Set-SmbServerConfiguration -EnableSMB1Protocol $false
Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol</code></pre>
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="remoto-rdp" class="text-2xl font-semibold mb-4">8. Configuraci√≥n de Acceso Remoto (RDP)</h2>
                    <p class="mb-4">
                        Si necesitas acceso remoto, configura RDP de forma segura.
                    </p>
                    
                    <div class="command-block">
                        <pre><code># PowerShell - Habilitar RDP con seguridad mejorada
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" -Value 0

# Requerir autenticaci√≥n de nivel de red
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "UserAuthentication" -Value 1

# Cambiar puerto RDP (opcional, requiere reinicio)
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value 3390

# Configurar firewall para nuevo puerto
New-NetFirewallRule -DisplayName "RDP Custom Port" -Direction Inbound -LocalPort 3390 -Protocol TCP -Action Allow

# Restringir usuarios que pueden hacer RDP
net localgroup "Remote Desktop Users" /add "usuario-especifico"</code></pre>
                    </div>
                    
                    <div class="alert alert-warning">
                        <strong>Mejor pr√°ctica:</strong> Si es posible, usa VPN para acceso remoto en lugar de exponer RDP directamente a Internet. 
                        Si debes exponer RDP, usa autenticaci√≥n de dos factores y cambia el puerto por defecto.
                    </div>
                </section>
                
                <section class="mb-8">
                    <h2 id="referencias" class="text-2xl font-semibold mb-4">Referencias y Recursos</h2>
                    <ul class="list-disc list-inside space-y-2">
                        <li><a href="https://www.cisecurity.org/benchmark/microsoft_windows" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">CIS Windows 10/11 Benchmark</a></li>
                        <li><a href="https://docs.microsoft.com/en-us/windows/security/" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">Microsoft Security Documentation</a></li>
                        <li><a href="https://admx.help/" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">Group Policy Settings Reference</a></li>
                        <li><a href="https://www.stigviewer.com/stig/microsoft_windows_10/" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank">DISA STIG for Windows 10</a></li>
                    </ul>
                </section>
            </article>
        </main>
        
        <footer class="border-t border-gray-200 dark:border-gray-700 mt-12 py-8">
            <div class="max-w-5xl mx-auto px-6">
                <p class="text-sm text-gray-600 dark:text-gray-400 text-center">
                    √öltima actualizaci√≥n: 2025-01-XX | 
                    <a href="https://github.com/Remiily/cybersec-handbook" class="text-blue-600 dark:text-blue-400 hover:underline">Editar en GitHub</a>
                </p>
            </div>
        </footer>
    </div>
    
    <script src="../../../assets/js/main.js"></script>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
</body>
</html>
