<!DOCTYPE html>
<html lang="es" x-data="app" x-init="init()" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pentesting R√°pido Web - CyberSec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>tailwind.config = { darkMode: 'class' }</script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <header class="sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-4">
                    <button @click="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden sidebar-toggle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <a href="../../index.html" class="flex items-center gap-2">
                        <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">üõ°Ô∏è CyberSec Handbook</h1>
                    </a>
                </div>
                <button @click="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg x-show="!darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                    <svg x-show="darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    <div x-show="sidebarOpen" @click="closeSidebar()" class="sidebar-overlay" x-cloak></div>
    <div class="flex relative">
        <aside :class="sidebarOpen ? 'open' : ''" class="sidebar">
            <nav class="p-4 space-y-2">
                <a href="../../index.html" class="nav-link block px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">üè† Inicio</a>
                <div class="mt-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2">Pentesting</h3>
                    <a href="web-security-quick-check.html" class="nav-link block px-3 py-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 font-medium">Pentesting R√°pido Web</a>
                    <a href="methodology-guide.html" class="nav-link block px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-sm">Metodolog√≠a Pentesting</a>
                    <a href="tools-setup.html" class="nav-link block px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-sm">Herramientas</a>
                </div>
            </nav>
        </aside>
        <main class="flex-1 min-h-screen lg:ml-64">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <article>
                    <header class="mb-8">
                        <h1 class="text-4xl font-bold mb-4">Pentesting R√°pido Web</h1>
                        <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">Verificaci√≥n r√°pida de seguridad web en pocos pasos</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="badge badge-intermediate">Nivel: Intermedio</span>
                            <span class="badge">‚ö° R√°pido</span>
                            <span class="badge">üåê Web Security</span>
                        </div>
                    </header>
                    <div id="table-of-contents" class="toc"></div>
                    <div class="prose prose-lg dark:prose-invert max-w-none">
                        <div class="alert alert-info mb-6">
                            <p class="font-semibold mb-2">‚ö†Ô∏è Aviso Legal</p>
                            <p>Esta gu√≠a es solo para fines educativos y testing autorizado. Siempre obt√©n permiso expl√≠cito antes de testear cualquier aplicaci√≥n web.</p>
                        </div>

                        <h2 id="checklist-rapido">Checklist R√°pido de Seguridad Web</h2>
                        <div class="checklist-container bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-6" data-checklist-id="web-security-quick">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-semibold">Verificaci√≥n R√°pida</h3>
                                <div class="flex gap-2">
                                    <button onclick="resetChecklist(this.closest('.checklist-container'))" class="text-sm px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600">Resetear</button>
                                    <button onclick="exportChecklist(this.closest('.checklist-container'))" class="text-sm px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">Exportar</button>
                                </div>
                            </div>
                            <div class="progress-bar mb-4">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 progress-text">0/10 completado (0%)</p>
                            <div class="space-y-2">
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Reconocimiento inicial (DNS, subdominios, puertos)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Headers de seguridad verificados (HTTPS, CSP, etc.)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Vulnerabilidades b√°sicas (SQLi, XSS, CSRF)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Exposici√≥n de informaci√≥n (robots.txt, archivos ocultos)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Autenticaci√≥n y autorizaci√≥n testeadas</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Configuraci√≥n segura (permisos, errores)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Dependencias actualizadas (tecnolog√≠as detectadas)</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Rate limiting y protecci√≥n anti-brute force</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Logs y monitoreo revisados</span>
                                </label>
                                <label class="checklist-item">
                                    <input type="checkbox" onchange="handleChecklistChange(event, this.closest('.checklist-container'))">
                                    <span>Reporte documentado</span>
                                </label>
                            </div>
                        </div>

                        <h2 id="paso-1-reconocimiento">Paso 1: Reconocimiento Inicial</h2>
                        <p>Recopilar informaci√≥n b√°sica sobre el objetivo.</p>

                        <h3>Script: Reconocimiento B√°sico</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('#!/usr/bin/env python3\n\"\"\"\nScript de reconocimiento b√°sico para pentesting web\nUso: python3 recon_basic.py https://ejemplo.com\n\"\"\"\nimport sys\nimport requests\nimport socket\nfrom urllib.parse import urlparse\nfrom datetime import datetime\n\ndef get_domain_info(url):\n    \"\"\"Obtener informaci√≥n b√°sica del dominio\"\"\"\n    parsed = urlparse(url)\n    domain = parsed.netloc or parsed.path.split(\'/\')[0]\n    \n    print(f\"\\n[+] Objetivo: {domain}\")\n    print(f\"[+] Fecha: {datetime.now().strftime(\'%Y-%m-%d %H:%M:%S\')}\")\n    print(\"\\n[*] Informaci√≥n DNS:\")\n    \n    try:\n        ip = socket.gethostbyname(domain)\n        print(f\"    IP: {ip}\")\n    except socket.gaierror:\n        print(f\"    [!] No se pudo resolver {domain}\")\n        return\n    \n    # Headers HTTP\n    print(\"\\n[*] Headers HTTP:\")\n    try:\n        response = requests.get(url, timeout=10, allow_redirects=True)\n        print(f\"    Status: {response.status_code}\")\n        print(f\"    Server: {response.headers.get(\'Server\', \'N/A\')}\")\n        print(f\"    Powered-By: {response.headers.get(\'X-Powered-By\', \'N/A\')}\")\n        \n        # Headers de seguridad\n        security_headers = [\n            \'Strict-Transport-Security\',\n            \'Content-Security-Policy\',\n            \'X-Frame-Options\',\n            \'X-Content-Type-Options\',\n            \'X-XSS-Protection\',\n            \'Referrer-Policy\'\n        ]\n        \n        print(\"\\n[*] Headers de Seguridad:\")\n        for header in security_headers:\n            value = response.headers.get(header, \'NO PRESENTE\')\n            status = \"‚úì\" if value != \"NO PRESENTE\" else \"‚úó\"\n            print(f\"    {status} {header}: {value}\")\n            \n    except requests.RequestException as e:\n        print(f\"    [!] Error: {e}\")\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print(\"Uso: python3 recon_basic.py <URL>\")\n        sys.exit(1)\n    \n    target = sys.argv[1]\n    if not target.startswith(\'http\'):\n        target = f\"https://{target}\"\n    \n    get_domain_info(target)')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>#!/usr/bin/env python3
"""
Script de reconocimiento b√°sico para pentesting web
Uso: python3 recon_basic.py https://ejemplo.com
"""
import sys
import requests
import socket
from urllib.parse import urlparse
from datetime import datetime

def get_domain_info(url):
    """Obtener informaci√≥n b√°sica del dominio"""
    parsed = urlparse(url)
    domain = parsed.netloc or parsed.path.split('/')[0]
    
    print(f"\n[+] Objetivo: {domain}")
    print(f"[+] Fecha: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("\n[*] Informaci√≥n DNS:")
    
    try:
        ip = socket.gethostbyname(domain)
        print(f"    IP: {ip}")
    except socket.gaierror:
        print(f"    [!] No se pudo resolver {domain}")
        return
    
    # Headers HTTP
    print("\n[*] Headers HTTP:")
    try:
        response = requests.get(url, timeout=10, allow_redirects=True)
        print(f"    Status: {response.status_code}")
        print(f"    Server: {response.headers.get('Server', 'N/A')}")
        print(f"    Powered-By: {response.headers.get('X-Powered-By', 'N/A')}")
        
        # Headers de seguridad
        security_headers = [
            'Strict-Transport-Security',
            'Content-Security-Policy',
            'X-Frame-Options',
            'X-Content-Type-Options',
            'X-XSS-Protection',
            'Referrer-Policy'
        ]
        
        print("\n[*] Headers de Seguridad:")
        for header in security_headers:
            value = response.headers.get(header, 'NO PRESENTE')
            status = "‚úì" if value != "NO PRESENTE" else "‚úó"
            print(f"    {status} {header}: {value}")
            
    except requests.RequestException as e:
        print(f"    [!] Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Uso: python3 recon_basic.py <URL>")
        sys.exit(1)
    
    target = sys.argv[1]
    if not target.startswith('http'):
        target = f"https://{target}"
    
    get_domain_info(target)</code></pre>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                <strong>Guardar como:</strong> <code>recon_basic.py</code><br>
                                <strong>Uso:</strong> <code>python3 recon_basic.py https://ejemplo.com</code><br>
                                <strong>Requisitos:</strong> <code>pip install requests</code>
                            </p>
                        </div>

                        <h3>Comandos R√°pidos de Reconocimiento</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# DNS lookup\nnslookup ejemplo.com\ndig ejemplo.com\n\n# Subdominios (requiere herramientas)\nsubfinder -d ejemplo.com\namass enum -d ejemplo.com\n\n# Puertos comunes\nnmap -p 80,443,8080,8443 ejemplo.com\nnmap -sS -p- -T4 ejemplo.com  # Scan completo (m√°s lento)\n\n# Tecnolog√≠as\nwhatweb https://ejemplo.com\nwappalyzer  # Extensi√≥n de navegador\n\n# Certificado SSL\nopenssl s_client -connect ejemplo.com:443 -showcerts')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># DNS lookup
nslookup ejemplo.com
dig ejemplo.com

# Subdominios (requiere herramientas)
subfinder -d ejemplo.com
amass enum -d ejemplo.com

# Puertos comunes
nmap -p 80,443,8080,8443 ejemplo.com
nmap -sS -p- -T4 ejemplo.com  # Scan completo (m√°s lento)

# Tecnolog√≠as
whatweb https://ejemplo.com
wappalyzer  # Extensi√≥n de navegador

# Certificado SSL
openssl s_client -connect ejemplo.com:443 -showcerts</code></pre>
                        </div>

                        <h2 id="paso-2-headers-seguridad">Paso 2: Verificar Headers de Seguridad</h2>
                        <p>Los headers HTTP de seguridad son fundamentales para proteger la aplicaci√≥n.</p>

                        <h3>Script: Verificador de Headers de Seguridad</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('#!/usr/bin/env python3\n\"\"\"\nVerificador de headers de seguridad HTTP\nUso: python3 check_headers.py https://ejemplo.com\n\"\"\"\nimport sys\nimport requests\nfrom urllib.parse import urlparse\n\ndef check_security_headers(url):\n    \"\"\"Verificar headers de seguridad\"\"\"\n    \n    security_headers = {\n        \'Strict-Transport-Security\': {\n            \'required\': True,\n            \'description\': \'Forza HTTPS\',\n            \'recommended\': \'max-age=31536000; includeSubDomains\'\n        },\n        \'Content-Security-Policy\': {\n            \'required\': True,\n            \'description\': \'Previene XSS y data injection\',\n            \'recommended\': \'default-src \'self\'\'\n        },\n        \'X-Frame-Options\': {\n            \'required\': True,\n            \'description\': \'Previene clickjacking\',\n            \'recommended\': \'DENY\' or \'SAMEORIGIN\'\n        },\n        \'X-Content-Type-Options\': {\n            \'required\': True,\n            \'description\': \'Previene MIME sniffing\',\n            \'recommended\': \'nosniff\'\n        },\n        \'X-XSS-Protection\': {\n            \'required\': False,\n            \'description\': \'Protecci√≥n XSS (deprecated pero com√∫n)\',\n            \'recommended\': \'1; mode=block\'\n        },\n        \'Referrer-Policy\': {\n            \'required\': True,\n            \'description\': \'Controla informaci√≥n de referrer\',\n            \'recommended\': \'strict-origin-when-cross-origin\'\n        },\n        \'Permissions-Policy\': {\n            \'required\': False,\n            \'description\': \'Controla caracter√≠sticas del navegador\',\n            \'recommended\': \'geolocation=(), microphone=()\'\n        }\n    }\n    \n    print(f\"\\n[*] Verificando headers de seguridad para: {url}\\n\")\n    \n    try:\n        response = requests.get(url, timeout=10, allow_redirects=True)\n        \n        score = 0\n        total = sum(1 for h in security_headers.values() if h[\'required\'])\n        \n        for header, info in security_headers.items():\n            value = response.headers.get(header)\n            \n            if value:\n                status = \"‚úì\"\n                if info[\'required\']:\n                    score += 1\n                color = \"\\033[92m\"  # Verde\n            else:\n                status = \"‚úó\"\n                color = \"\\033[91m\"  # Rojo\n            \n            required_mark = \"[REQUERIDO]\" if info[\'required\'] else \"[OPCIONAL]\"\n            print(f\"{color}{status}\\033[0m {header} {required_mark}\")\n            print(f\"    Descripci√≥n: {info[\'description\']}\")\n            if value:\n                print(f\"    Valor: {value}\")\n            else:\n                print(f\"    Recomendado: {info[\'recommended\']}\")\n            print()\n        \n        percentage = (score / total) * 100\n        print(f\"\\n[+] Score: {score}/{total} ({percentage:.1f}%)\")\n        \n        if percentage == 100:\n            print(\"\\033[92m[+] Excelente! Todos los headers requeridos est√°n presentes.\\033[0m\")\n        elif percentage >= 70:\n            print(\"\\033[93m[!] Buena configuraci√≥n, pero faltan algunos headers.\\033[0m\")\n        else:\n            print(\"\\033[91m[!] Faltan muchos headers de seguridad. Se recomienda mejorar la configuraci√≥n.\\033[0m\")\n            \n    except requests.RequestException as e:\n        print(f\"[!] Error al conectar: {e}\")\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print(\"Uso: python3 check_headers.py <URL>\")\n        sys.exit(1)\n    \n    target = sys.argv[1]\n    if not target.startswith(\'http\'):\n        target = f\"https://{target}\"\n    \n    check_security_headers(target)')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>#!/usr/bin/env python3
"""
Verificador de headers de seguridad HTTP
Uso: python3 check_headers.py https://ejemplo.com
"""
import sys
import requests
from urllib.parse import urlparse

def check_security_headers(url):
    """Verificar headers de seguridad"""
    
    security_headers = {
        'Strict-Transport-Security': {
            'required': True,
            'description': 'Forza HTTPS',
            'recommended': 'max-age=31536000; includeSubDomains'
        },
        'Content-Security-Policy': {
            'required': True,
            'description': 'Previene XSS y data injection',
            'recommended': "default-src 'self'"
        },
        'X-Frame-Options': {
            'required': True,
            'description': 'Previene clickjacking',
            'recommended': 'DENY' or 'SAMEORIGIN'
        },
        'X-Content-Type-Options': {
            'required': True,
            'description': 'Previene MIME sniffing',
            'recommended': 'nosniff'
        },
        'X-XSS-Protection': {
            'required': False,
            'description': 'Protecci√≥n XSS (deprecated pero com√∫n)',
            'recommended': '1; mode=block'
        },
        'Referrer-Policy': {
            'required': True,
            'description': 'Controla informaci√≥n de referrer',
            'recommended': 'strict-origin-when-cross-origin'
        },
        'Permissions-Policy': {
            'required': False,
            'description': 'Controla caracter√≠sticas del navegador',
            'recommended': 'geolocation=(), microphone=()'
        }
    }
    
    print(f"\n[*] Verificando headers de seguridad para: {url}\n")
    
    try:
        response = requests.get(url, timeout=10, allow_redirects=True)
        
        score = 0
        total = sum(1 for h in security_headers.values() if h['required'])
        
        for header, info in security_headers.items():
            value = response.headers.get(header)
            
            if value:
                status = "‚úì"
                if info['required']:
                    score += 1
                color = "\033[92m"  # Verde
            else:
                status = "‚úó"
                color = "\033[91m"  # Rojo
            
            required_mark = "[REQUERIDO]" if info['required'] else "[OPCIONAL]"
            print(f"{color}{status}\033[0m {header} {required_mark}")
            print(f"    Descripci√≥n: {info['description']}")
            if value:
                print(f"    Valor: {value}")
            else:
                print(f"    Recomendado: {info['recommended']}")
            print()
        
        percentage = (score / total) * 100
        print(f"\n[+] Score: {score}/{total} ({percentage:.1f}%)")
        
        if percentage == 100:
            print("\033[92m[+] Excelente! Todos los headers requeridos est√°n presentes.\033[0m")
        elif percentage >= 70:
            print("\033[93m[!] Buena configuraci√≥n, pero faltan algunos headers.\033[0m")
        else:
            print("\033[91m[!] Faltan muchos headers de seguridad. Se recomienda mejorar la configuraci√≥n.\033[0m")
            
    except requests.RequestException as e:
        print(f"[!] Error al conectar: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Uso: python3 check_headers.py <URL>")
        sys.exit(1)
    
    target = sys.argv[1]
    if not target.startswith('http'):
        target = f"https://{target}"
    
    check_security_headers(target)</code></pre>
                        </div>

                        <h2 id="paso-3-vulnerabilidades-basicas">Paso 3: Test de Vulnerabilidades B√°sicas</h2>
                        <p>Verificar vulnerabilidades comunes como SQL Injection, XSS, y exposici√≥n de archivos.</p>

                        <h3>Script: Buscador de Archivos Sensibles</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('#!/usr/bin/env python3\n\"\"\"\nBuscador de archivos y directorios comunes\nUso: python3 find_files.py https://ejemplo.com\n\"\"\"\nimport sys\nimport requests\nfrom urllib.parse import urljoin\n\n# Lista com√∫n de archivos/directorios a buscar\nCOMMON_PATHS = [\n    # Archivos de configuraci√≥n\n    \'robots.txt\',\n    \'.env\',\n    \'config.php\',\n    \'web.config\',\n    \'.git/config\',\n    \'.gitignore\',\n    \'package.json\',\n    \'composer.json\',\n    \n    # Directorios comunes\n    \'admin/\',\n    \'administrator/\',\n    \'backup/\',\n    \'backups/\',\n    \'tmp/\',\n    \'temp/\',\n    \'test/\',\n    \'dev/\',\n    \'staging/\',\n    \n    # Archivos de backup\n    \'backup.sql\',\n    \'database.sql\',\n    \'dump.sql\',\n    \'*.bak\',\n    \'*.old\',\n    \n    # Logs\n    \'logs/\',\n    \'log/\',\n    \'error.log\',\n    \'access.log\',\n]\n\ndef find_files(base_url):\n    \"\"\"Buscar archivos y directorios comunes\"\"\"\n    \n    base_url = base_url.rstrip(\'/\')\n    found = []\n    \n    print(f\"\\n[*] Buscando archivos comunes en: {base_url}\\n\")\n    \n    for path in COMMON_PATHS:\n        url = urljoin(base_url, path)\n        \n        try:\n            response = requests.get(url, timeout=5, allow_redirects=False)\n            \n            if response.status_code == 200:\n                status = \"\\033[91m[!] ENCONTRADO\\033[0m\"\n                found.append((url, response.status_code, len(response.content)))\n            elif response.status_code == 403:\n                status = \"\\033[93m[?] Prohibido\\033[0m\"\n            elif response.status_code == 301 or response.status_code == 302:\n                status = \"\\033[96m[‚Üí] Redirecci√≥n\\033[0m\"\n            else:\n                status = \"\\033[90m[-] No encontrado\\033[0m\"\n            \n            print(f\"{status} [{response.status_code}] {url}\")\n            \n        except requests.RequestException:\n            print(f\"\\033[90m[-] Error\\033[0m {url}\")\n    \n    print(f\"\\n[+] Total encontrados: {len(found)}\")\n    if found:\n        print(\"\\n[!] Archivos/Directorios encontrados:\")\n        for url, status, size in found:\n            print(f\"    - {url} ({size} bytes)\")'')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>#!/usr/bin/env python3
"""
Buscador de archivos y directorios comunes
Uso: python3 find_files.py https://ejemplo.com
"""
import sys
import requests
from urllib.parse import urljoin

# Lista com√∫n de archivos/directorios a buscar
COMMON_PATHS = [
    # Archivos de configuraci√≥n
    'robots.txt',
    '.env',
    'config.php',
    'web.config',
    '.git/config',
    '.gitignore',
    'package.json',
    'composer.json',
    
    # Directorios comunes
    'admin/',
    'administrator/',
    'backup/',
    'backups/',
    'tmp/',
    'temp/',
    'test/',
    'dev/',
    'staging/',
    
    # Archivos de backup
    'backup.sql',
    'database.sql',
    'dump.sql',
    '*.bak',
    '*.old',
    
    # Logs
    'logs/',
    'log/',
    'error.log',
    'access.log',
]

def find_files(base_url):
    """Buscar archivos y directorios comunes"""
    
    base_url = base_url.rstrip('/')
    found = []
    
    print(f"\n[*] Buscando archivos comunes en: {base_url}\n")
    
    for path in COMMON_PATHS:
        url = urljoin(base_url, path)
        
        try:
            response = requests.get(url, timeout=5, allow_redirects=False)
            
            if response.status_code == 200:
                status = "\033[91m[!] ENCONTRADO\033[0m"
                found.append((url, response.status_code, len(response.content)))
            elif response.status_code == 403:
                status = "\033[93m[?] Prohibido\033[0m"
            elif response.status_code == 301 or response.status_code == 302:
                status = "\033[96m[‚Üí] Redirecci√≥n\033[0m"
            else:
                status = "\033[90m[-] No encontrado\033[0m"
            
            print(f"{status} [{response.status_code}] {url}")
            
        except requests.RequestException:
            print(f"\033[90m[-] Error\033[0m {url}")
    
    print(f"\n[+] Total encontrados: {len(found)}")
    if found:
        print("\n[!] Archivos/Directorios encontrados:")
        for url, status, size in found:
            print(f"    - {url} ({size} bytes)")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Uso: python3 find_files.py <URL>")
        sys.exit(1)
    
    target = sys.argv[1]
    if not target.startswith('http'):
        target = f"https://{target}"
    
    find_files(target)</code></pre>
                        </div>

                        <h3>Test SQL Injection B√°sico</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Test b√°sico de SQL Injection\n# Buscar par√°metros GET/POST y probar payloads\n\n# Payloads comunes:\n# \' OR \'1\'=\'1\n# \' OR 1=1--\n# \' UNION SELECT NULL--\n# \' AND 1=1--\n# \' AND 1=2--\n\n# Ejemplo con curl:\ncurl \"https://ejemplo.com/search?q=\' OR \'1\'=\'1\"\n\n# Usar herramientas especializadas:\nsqlmap -u \"https://ejemplo.com/search?q=test\" --batch\nsqlmap -u \"https://ejemplo.com\" --forms --batch\n\n# Para POST:\nsqlmap -u \"https://ejemplo.com/login\" --data=\"user=test&pass=test\" --batch')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Test b√°sico de SQL Injection
# Buscar par√°metros GET/POST y probar payloads

# Payloads comunes:
# ' OR '1'='1
# ' OR 1=1--
# ' UNION SELECT NULL--
# ' AND 1=1--
# ' AND 1=2--

# Ejemplo con curl:
curl "https://ejemplo.com/search?q=' OR '1'='1"

# Usar herramientas especializadas:
sqlmap -u "https://ejemplo.com/search?q=test" --batch
sqlmap -u "https://ejemplo.com" --forms --batch

# Para POST:
sqlmap -u "https://ejemplo.com/login" --data="user=test&pass=test" --batch</code></pre>
                        </div>

                        <h2 id="paso-4-herramientas-automatizadas">Paso 4: Herramientas Automatizadas</h2>
                        <p>Herramientas que automatizan muchos tests comunes.</p>

                        <div class="overflow-x-auto mb-6">
                            <table>
                                <thead>
                                    <tr><th>Herramienta</th><th>Uso</th><th>Instalaci√≥n</th></tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>nikto</code></td>
                                        <td>Scan b√°sico de vulnerabilidades web</td>
                                        <td><code>sudo apt install nikto</code></td>
                                    </tr>
                                    <tr>
                                        <td><code>sqlmap</code></td>
                                        <td>SQL Injection automatizado</td>
                                        <td><code>pip install sqlmap</code></td>
                                    </tr>
                                    <tr>
                                        <td><code>nmap</code></td>
                                        <td>Scan de puertos y servicios</td>
                                        <td><code>sudo apt install nmap</code></td>
                                    </tr>
                                    <tr>
                                        <td><code>Burp Suite</code></td>
                                        <td>Proxy HTTP/HTTPS y testing manual</td>
                                        <td>Descargar de portswigger.net</td>
                                    </tr>
                                    <tr>
                                        <td><code>OWASP ZAP</code></td>
                                        <td>Scanner automatizado OWASP</td>
                                        <td><code>sudo apt install zaproxy</code></td>
                                    </tr>
                                    <tr>
                                        <td><code>wfuzz</code></td>
                                        <td>Fuzzing web y brute force</td>
                                        <td><code>pip install wfuzz</code></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h3>Ejemplo: Scan R√°pido con Nikto</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Scan b√°sico\nnikto -h https://ejemplo.com\n\n# Scan con output a archivo\nnikto -h https://ejemplo.com -o report.html -Format htm\n\n# Scan espec√≠fico de puerto\nnikto -h ejemplo.com -p 8080\n\n# Scan con autenticaci√≥n b√°sica\nnikto -h https://ejemplo.com -id usuario:contrase√±a')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Scan b√°sico
nikto -h https://ejemplo.com

# Scan con output a archivo
nikto -h https://ejemplo.com -o report.html -Format htm

# Scan espec√≠fico de puerto
nikto -h ejemplo.com -p 8080

# Scan con autenticaci√≥n b√°sica
nikto -h https://ejemplo.com -id usuario:contrase√±a</code></pre>
                        </div>

                        <h2 id="script-completo">Script Completo: Pentesting R√°pido</h2>
                        <p>Script que combina m√∫ltiples verificaciones en una ejecuci√≥n.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('#!/usr/bin/env python3\n\"\"\"\nScript completo de pentesting r√°pido web\nCombina reconocimiento, headers, y b√∫squeda de archivos\nUso: python3 quick_pentest.py https://ejemplo.com\n\"\"\"\nimport sys\nimport requests\nimport socket\nfrom urllib.parse import urlparse, urljoin\nfrom datetime import datetime\n\ndef quick_pentest(url):\n    \"\"\"Ejecutar pentest r√°pido\"\"\"\n    \n    print(\"=\" * 60)\n    print(f\"PENTEST R√ÅPIDO WEB\")\n    print(f\"Objetivo: {url}\")\n    print(f\"Fecha: {datetime.now().strftime(\'%Y-%m-%d %H:%M:%S\')}\")\n    print(\"=\" * 60)\n    \n    parsed = urlparse(url)\n    domain = parsed.netloc or parsed.path.split(\'/\')[0]\n    \n    # 1. Reconocimiento DNS\n    print(\"\\n[1/4] RECONOCIMIENTO DNS\")\n    print(\"-\" * 60)\n    try:\n        ip = socket.gethostbyname(domain)\n        print(f\"‚úì IP: {ip}\")\n    except socket.gaierror:\n        print(f\"‚úó No se pudo resolver {domain}\")\n        return\n    \n    # 2. Headers HTTP y seguridad\n    print(\"\\n[2/4] HEADERS HTTP Y SEGURIDAD\")\n    print(\"-\" * 60)\n    try:\n        response = requests.get(url, timeout=10, allow_redirects=True)\n        print(f\"‚úì Status: {response.status_code}\")\n        print(f\"‚úì Server: {response.headers.get(\'Server\', \'N/A\')}\")\n        \n        security_headers = [\n            \'Strict-Transport-Security\',\n            \'Content-Security-Policy\',\n            \'X-Frame-Options\',\n            \'X-Content-Type-Options\',\n            \'X-XSS-Protection\',\n            \'Referrer-Policy\'\n        ]\n        \n        present = 0\n        for header in security_headers:\n            if header in response.headers:\n                print(f\"‚úì {header}: {response.headers[header]}\")\n                present += 1\n            else:\n                print(f\"‚úó {header}: NO PRESENTE\")\n        \n        print(f\"\\nScore headers: {present}/{len(security_headers)}\")\n        \n    except requests.RequestException as e:\n        print(f\"‚úó Error: {e}\")\n        return\n    \n    # 3. Archivos comunes\n    print(\"\\n[3/4] B√öSQUEDA DE ARCHIVOS COMUNES\")\n    print(\"-\" * 60)\n    common_paths = [\n        \'robots.txt\', \'.env\', \'config.php\', \'.git/config\',\n        \'admin/\', \'backup/\', \'test/\', \'backup.sql\'\n    ]\n    \n    found = []\n    for path in common_paths:\n        test_url = urljoin(url, path)\n        try:\n            resp = requests.get(test_url, timeout=3, allow_redirects=False)\n            if resp.status_code == 200:\n                print(f\"‚ö† ENCONTRADO: {test_url}\")\n                found.append(test_url)\n        except:\n            pass\n    \n    if not found:\n        print(\"‚úì No se encontraron archivos comunes expuestos\")\n    \n    # 4. Resumen\n    print(\"\\n[4/4] RESUMEN\")\n    print(\"-\" * 60)\n    print(f\"‚úì Reconocimiento completado\")\n    print(f\"‚úì Headers verificados: {present}/{len(security_headers)}\")\n    print(f\"‚ö† Archivos encontrados: {len(found)}\")\n    \n    if found:\n        print(\"\\n[!] Archivos sensibles encontrados:\")\n        for f in found:\n            print(f\"    - {f}\")\n    \n    print(\"\\n\" + \"=\" * 60)\n    print(\"Pentest r√°pido completado\")\n    print(\"=\" * 60)\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print(\"Uso: python3 quick_pentest.py <URL>\")\n        sys.exit(1)\n    \n    target = sys.argv[1]\n    if not target.startswith(\'http\'):\n        target = f\"https://{target}\"\n    \n    quick_pentest(target)')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>#!/usr/bin/env python3
"""
Script completo de pentesting r√°pido web
Combina reconocimiento, headers, y b√∫squeda de archivos
Uso: python3 quick_pentest.py https://ejemplo.com
"""
import sys
import requests
import socket
from urllib.parse import urlparse, urljoin
from datetime import datetime

def quick_pentest(url):
    """Ejecutar pentest r√°pido"""
    
    print("=" * 60)
    print(f"PENTEST R√ÅPIDO WEB")
    print(f"Objetivo: {url}")
    print(f"Fecha: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("=" * 60)
    
    parsed = urlparse(url)
    domain = parsed.netloc or parsed.path.split('/')[0]
    
    # 1. Reconocimiento DNS
    print("\n[1/4] RECONOCIMIENTO DNS")
    print("-" * 60)
    try:
        ip = socket.gethostbyname(domain)
        print(f"‚úì IP: {ip}")
    except socket.gaierror:
        print(f"‚úó No se pudo resolver {domain}")
        return
    
    # 2. Headers HTTP y seguridad
    print("\n[2/4] HEADERS HTTP Y SEGURIDAD")
    print("-" * 60)
    try:
        response = requests.get(url, timeout=10, allow_redirects=True)
        print(f"‚úì Status: {response.status_code}")
        print(f"‚úì Server: {response.headers.get('Server', 'N/A')}")
        
        security_headers = [
            'Strict-Transport-Security',
            'Content-Security-Policy',
            'X-Frame-Options',
            'X-Content-Type-Options',
            'X-XSS-Protection',
            'Referrer-Policy'
        ]
        
        present = 0
        for header in security_headers:
            if header in response.headers:
                print(f"‚úì {header}: {response.headers[header]}")
                present += 1
            else:
                print(f"‚úó {header}: NO PRESENTE")
        
        print(f"\nScore headers: {present}/{len(security_headers)}")
        
    except requests.RequestException as e:
        print(f"‚úó Error: {e}")
        return
    
    # 3. Archivos comunes
    print("\n[3/4] B√öSQUEDA DE ARCHIVOS COMUNES")
    print("-" * 60)
    common_paths = [
        'robots.txt', '.env', 'config.php', '.git/config',
        'admin/', 'backup/', 'test/', 'backup.sql'
    ]
    
    found = []
    for path in common_paths:
        test_url = urljoin(url, path)
        try:
            resp = requests.get(test_url, timeout=3, allow_redirects=False)
            if resp.status_code == 200:
                print(f"‚ö† ENCONTRADO: {test_url}")
                found.append(test_url)
        except:
            pass
    
    if not found:
        print("‚úì No se encontraron archivos comunes expuestos")
    
    # 4. Resumen
    print("\n[4/4] RESUMEN")
    print("-" * 60)
    print(f"‚úì Reconocimiento completado")
    print(f"‚úì Headers verificados: {present}/{len(security_headers)}")
    print(f"‚ö† Archivos encontrados: {len(found)}")
    
    if found:
        print("\n[!] Archivos sensibles encontrados:")
        for f in found:
            print(f"    - {f}")
    
    print("\n" + "=" * 60)
    print("Pentest r√°pido completado")
    print("=" * 60)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Uso: python3 quick_pentest.py <URL>")
        sys.exit(1)
    
    target = sys.argv[1]
    if not target.startswith('http'):
        target = f"https://{target}"
    
    quick_pentest(target)</code></pre>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                <strong>Guardar como:</strong> <code>quick_pentest.py</code><br>
                                <strong>Uso:</strong> <code>python3 quick_pentest.py https://ejemplo.com</code><br>
                                <strong>Requisitos:</strong> <code>pip install requests</code>
                            </p>
                        </div>

                        <h2 id="cheatsheet-rapido">Cheatsheet R√°pido</h2>
                        <div class="overflow-x-auto mb-6">
                            <table>
                                <thead>
                                    <tr><th>Tarea</th><th>Comando/Herramienta</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td>Reconocimiento DNS</td><td><code>nslookup dominio.com</code></td></tr>
                                    <tr><td>Headers HTTP</td><td><code>curl -I https://ejemplo.com</code></td></tr>
                                    <tr><td>Headers de seguridad</td><td><code>python3 check_headers.py URL</code></td></tr>
                                    <tr><td>Archivos comunes</td><td><code>python3 find_files.py URL</code></td></tr>
                                    <tr><td>Pentest completo r√°pido</td><td><code>python3 quick_pentest.py URL</code></td></tr>
                                    <tr><td>SQL Injection</td><td><code>sqlmap -u URL --batch</code></td></tr>
                                    <tr><td>Scan b√°sico</td><td><code>nikto -h URL</code></td></tr>
                                    <tr><td>Puertos abiertos</td><td><code>nmap -p 80,443,8080 dominio.com</code></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="alert alert-success mt-8">
                            <p class="font-semibold mb-2">‚úÖ Pentesting R√°pido</p>
                            <p>Esta gu√≠a te da los pasos b√°sicos para verificar seguridad web r√°pidamente. Recuerda: siempre obt√©n autorizaci√≥n antes de testear. Para an√°lisis m√°s profundos, considera contratar un pentest profesional o usar herramientas avanzadas como Burp Suite Professional.</p>
                        </div>
                    </div>
                </article>
            </div>
        </main>
    </div>
    <footer class="bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-sm text-gray-600 dark:text-gray-400">Actualizado por m√≠ en Enero 2026</p>
                <a href="https://github.com/tu-usuario/cybersec-handbook" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">Editar en GitHub</a>
            </div>
        </div>
    </footer>
    <script src="../../assets/js/search.js"></script>
    <script src="../../assets/js/main.js"></script>
    <style>[x-cloak] { display: none !important; }</style>
</body>
</html>

