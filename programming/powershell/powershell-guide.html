<!DOCTYPE html>
<html lang="es" x-data="app" x-init="init()" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell para Ciberseguridad - CyberSec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>tailwind.config = { darkMode: 'class' }</script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <header class="sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-4">
                    <button @click="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden sidebar-toggle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <a href="https://remiily.github.io/cybersec-handbook/index.html" class="flex items-center gap-2">
                        <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">üõ°Ô∏è CyberSec Handbook</h1>
                    </a>
                </div>
                <button @click="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg x-show="!darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                    <svg x-show="darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    <div x-show="sidebarOpen" @click="closeSidebar()" class="sidebar-overlay" x-cloak></div>
    <div class="flex relative">
        <aside :class="sidebarOpen ? 'open' : ''" class="sidebar">
            <nav class="p-4 space-y-2">
                <!-- Navigation will be generated by navigation.js -->
            </nav>
        </aside>
        <main class="flex-1 min-h-screen lg:ml-64">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <article>
                    <header class="mb-8">
                        <h1 class="text-4xl font-bold mb-4">PowerShell para Ciberseguridad</h1>
                        <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">Gu√≠a completa de PowerShell para administraci√≥n Windows, forensics, automatizaci√≥n de seguridad y respuesta a incidentes</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="badge badge-intermediate">Nivel: Intermedio</span>
                            <span class="badge">ü™ü Windows</span>
                            <span class="badge">‚ö° Automatizaci√≥n</span>
                        </div>
                    </header>
                    <div id="table-of-contents" class="toc"></div>
                    <div class="prose prose-lg dark:prose-invert max-w-none">
                        <h2 id="introduccion">Introducci√≥n</h2>
                        <p>PowerShell es el shell y lenguaje de scripting de Microsoft, esencial para cualquier profesional de ciberseguridad que trabaje con entornos Windows. Esta gu√≠a cubre desde comandos b√°sicos hasta scripts avanzados para seguridad, forensics y automatizaci√≥n.</p>

                        <div class="alert alert-info mb-6">
                            <p class="font-semibold mb-2">üí° Importante</p>
                            <p>PowerShell est√° disponible en Windows, Linux y macOS. PowerShell Core (v6+) es multiplataforma, mientras que Windows PowerShell (v5.1) es espec√≠fico de Windows. Esta gu√≠a se enfoca en PowerShell para Windows, pero muchos conceptos aplican a PowerShell Core.</p>
                        </div>

                        <h2 id="fundamentos">Fundamentos de PowerShell</h2>

                        <h3 id="instalacion-version">Instalaci√≥n y Versiones</h3>
                        <p>Windows 10/11 incluye PowerShell 5.1 y PowerShell 7+ (Core). Para seguridad, siempre usa la versi√≥n m√°s reciente.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Verificar versi√≥n de PowerShell\n$PSVersionTable\n\n# Verificar versi√≥n espec√≠fica\n$PSVersionTable.PSVersion\n\n# Instalar PowerShell 7 (si no est√° instalado)\n# Descargar desde: https://aka.ms/powershell-release\n\n# Ejecutar PowerShell como administrador\n# Click derecho en PowerShell > Ejecutar como administrador')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar versi√≥n de PowerShell
$PSVersionTable

# Verificar versi√≥n espec√≠fica
$PSVersionTable.PSVersion

# Instalar PowerShell 7 (si no est√° instalado)
# Descargar desde: https://aka.ms/powershell-release

# Ejecutar PowerShell como administrador
# Click derecho en PowerShell > Ejecutar como administrador</code></pre>
                        </div>

                        <h3 id="politica-ejecucion">Pol√≠tica de Ejecuci√≥n</h3>
                        <p>PowerShell tiene pol√≠ticas de ejecuci√≥n que controlan qu√© scripts pueden ejecutarse. Para seguridad, es importante entender y configurar correctamente estas pol√≠ticas.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Ver pol√≠tica de ejecuci√≥n actual\nGet-ExecutionPolicy\n\n# Ver pol√≠ticas para todos los scopes\nGet-ExecutionPolicy -List\n\n# Cambiar pol√≠tica (requiere admin)\nSet-ExecutionPolicy RemoteSigned -Scope CurrentUser\n\n# Pol√≠ticas comunes:\n# - Restricted: No scripts permitidos\n# - AllSigned: Solo scripts firmados\n# - RemoteSigned: Scripts locales OK, remotos deben estar firmados\n# - Unrestricted: Todos los scripts (NO RECOMENDADO)\n\n# Bypass temporal (solo para testing)\npowershell -ExecutionPolicy Bypass -File script.ps1')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Ver pol√≠tica de ejecuci√≥n actual
Get-ExecutionPolicy

# Ver pol√≠ticas para todos los scopes
Get-ExecutionPolicy -List

# Cambiar pol√≠tica (requiere admin)
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

# Pol√≠ticas comunes:
# - Restricted: No scripts permitidos
# - AllSigned: Solo scripts firmados
# - RemoteSigned: Scripts locales OK, remotos deben estar firmados
# - Unrestricted: Todos los scripts (NO RECOMENDADO)

# Bypass temporal (solo para testing)
powershell -ExecutionPolicy Bypass -File script.ps1</code></pre>
                        </div>

                        <h2 id="comandos-esenciales">Comandos Esenciales para Seguridad</h2>

                        <h3 id="sistema-informacion">Informaci√≥n del Sistema</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Informaci√≥n del sistema\nGet-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, TotalPhysicalMemory\n\n# Informaci√≥n del OS\nGet-CimInstance Win32_OperatingSystem | Select-Object Caption, Version, InstallDate\n\n# Informaci√≥n de hardware\nGet-CimInstance Win32_ComputerSystem | Select-Object Manufacturer, Model, TotalPhysicalMemory\n\n# Procesador\nGet-CimInstance Win32_Processor | Select-Object Name, NumberOfCores, NumberOfLogicalProcessors')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Informaci√≥n del sistema
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, TotalPhysicalMemory

# Informaci√≥n del OS
Get-CimInstance Win32_OperatingSystem | Select-Object Caption, Version, InstallDate

# Informaci√≥n de hardware
Get-CimInstance Win32_ComputerSystem | Select-Object Manufacturer, Model, TotalPhysicalMemory

# Procesador
Get-CimInstance Win32_Processor | Select-Object Name, NumberOfCores, NumberOfLogicalProcessors</code></pre>
                        </div>

                        <h3 id="procesos-servicios">Procesos y Servicios</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Listar todos los procesos\nGet-Process | Format-Table -AutoSize\n\n# Procesos con mayor uso de CPU\nGet-Process | Sort-Object CPU -Descending | Select-Object -First 10\n\n# Procesos con mayor uso de memoria\nGet-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10\n\n# Informaci√≥n detallada de un proceso\nGet-Process -Name explorer | Select-Object *\n\n# Procesos por usuario\nGet-Process | Group-Object -Property UserName\n\n# Listar servicios\nGet-Service | Where-Object Status -eq Running\n\n# Servicios detenidos\nGet-Service | Where-Object Status -eq Stopped\n\n# Informaci√≥n detallada de servicio\nGet-Service -Name WinRM | Select-Object *')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Listar todos los procesos
Get-Process | Format-Table -AutoSize

# Procesos con mayor uso de CPU
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10

# Procesos con mayor uso de memoria
Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10

# Informaci√≥n detallada de un proceso
Get-Process -Name explorer | Select-Object *

# Procesos por usuario
Get-Process | Group-Object -Property UserName

# Listar servicios
Get-Service | Where-Object Status -eq Running

# Servicios detenidos
Get-Service | Where-Object Status -eq Stopped

# Informaci√≥n detallada de servicio
Get-Service -Name WinRM | Select-Object *</code></pre>
                        </div>

                        <h3 id="red-conexiones">Red y Conexiones</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Puertos abiertos y conexiones\nGet-NetTCPConnection | Where-Object State -eq Listen | Format-Table -AutoSize\n\n# Todas las conexiones activas\nGet-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, OwningProcess\n\n# Conexiones establecidas\nGet-NetTCPConnection | Where-Object State -eq Established\n\n# Proceso asociado a un puerto\nGet-NetTCPConnection -LocalPort 443 | Select-Object OwningProcess | ForEach-Object { Get-Process -Id $_.OwningProcess }\n\n# Configuraci√≥n de red\nGet-NetIPAddress | Where-Object AddressFamily -eq IPv4\n\n# Configuraci√≥n de DNS\nGet-DnsClientServerAddress\n\n# Rutas de red\nGet-NetRoute | Format-Table -AutoSize\n\n# Estad√≠sticas de red\nGet-NetTCPConnection | Measure-Object | Select-Object Count')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Puertos abiertos y conexiones
Get-NetTCPConnection | Where-Object State -eq Listen | Format-Table -AutoSize

# Todas las conexiones activas
Get-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, OwningProcess

# Conexiones establecidas
Get-NetTCPConnection | Where-Object State -eq Established

# Proceso asociado a un puerto
Get-NetTCPConnection -LocalPort 443 | Select-Object OwningProcess | ForEach-Object { Get-Process -Id $_.OwningProcess }

# Configuraci√≥n de red
Get-NetIPAddress | Where-Object AddressFamily -eq IPv4

# Configuraci√≥n de DNS
Get-DnsClientServerAddress

# Rutas de red
Get-NetRoute | Format-Table -AutoSize

# Estad√≠sticas de red
Get-NetTCPConnection | Measure-Object | Select-Object Count</code></pre>
                        </div>

                        <h3 id="usuarios-grupos">Usuarios y Grupos</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Usuarios locales\nGet-LocalUser | Format-Table -AutoSize\n\n# Informaci√≥n detallada de usuario\nGet-LocalUser -Name Administrador | Select-Object *\n\n# Grupos locales\nGet-LocalGroup | Format-Table -AutoSize\n\n# Miembros de un grupo\nGet-LocalGroupMember -Group Administrators\n\n# Miembros de todos los grupos administrativos\n$adminGroups = @(\"Administrators\", \"Domain Admins\", \"Enterprise Admins\")\nforeach ($group in $adminGroups) {\n    try {\n        Get-LocalGroupMember -Group $group -ErrorAction SilentlyContinue\n    } catch {}\n}\n\n# Usuarios con password nunca expira\nGet-LocalUser | Where-Object PasswordNeverExpires -eq $true\n\n# Usuarios deshabilitados\nGet-LocalUser | Where-Object Enabled -eq $false')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Usuarios locales
Get-LocalUser | Format-Table -AutoSize

# Informaci√≥n detallada de usuario
Get-LocalUser -Name Administrador | Select-Object *

# Grupos locales
Get-LocalGroup | Format-Table -AutoSize

# Miembros de un grupo
Get-LocalGroupMember -Group Administrators

# Miembros de todos los grupos administrativos
$adminGroups = @("Administrators", "Domain Admins", "Enterprise Admins")
foreach ($group in $adminGroups) {
    try {
        Get-LocalGroupMember -Group $group -ErrorAction SilentlyContinue
    } catch {}
}

# Usuarios con password nunca expira
Get-LocalUser | Where-Object PasswordNeverExpires -eq $true

# Usuarios deshabilitados
Get-LocalUser | Where-Object Enabled -eq $false</code></pre>
                        </div>

                        <h2 id="forensics-investigacion">Forensics e Investigaci√≥n</h2>

                        <h3 id="event-logs">An√°lisis de Event Logs</h3>
                        <p>Los Event Logs de Windows contienen informaci√≥n cr√≠tica para investigaciones de seguridad.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Listar logs disponibles\nGet-EventLog -List\n\n# Eventos de seguridad recientes\nGet-EventLog -LogName Security -Newest 50 | Format-Table -AutoSize\n\n# Logons exitosos (Event ID 4624)\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} | \n    Select-Object TimeCreated, Message | \n    Format-Table -AutoSize\n\n# Logons fallidos (Event ID 4625)\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | \n    Select-Object TimeCreated, Message | \n    Format-Table -AutoSize\n\n# Eventos de cuenta creada (Event ID 4720)\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4720} | \n    Select-Object TimeCreated, Message\n\n# Eventos de privilegios elevados (Event ID 4672)\nGet-WinEvent -FilterHashtable @{LogName='Security'; ID=4672} | \n    Select-Object TimeCreated, Message')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Listar logs disponibles
Get-EventLog -List

# Eventos de seguridad recientes
Get-EventLog -LogName Security -Newest 50 | Format-Table -AutoSize

# Logons exitosos (Event ID 4624)
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} | 
    Select-Object TimeCreated, Message | 
    Format-Table -AutoSize

# Logons fallidos (Event ID 4625)
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | 
    Select-Object TimeCreated, Message | 
    Format-Table -AutoSize

# Eventos de cuenta creada (Event ID 4720)
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4720} | 
    Select-Object TimeCreated, Message

# Eventos de privilegios elevados (Event ID 4672)
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4672} | 
    Select-Object TimeCreated, Message</code></pre>
                        </div>

                        <h3 id="procesos-sospechosos">Detecci√≥n de Procesos Sospechosos</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Procesos con alto uso de CPU\nGet-Process | Where-Object {$_.CPU -gt 100} | \n    Select-Object Name, CPU, Id, Path | \n    Sort-Object CPU -Descending\n\n# Procesos con alto uso de memoria\nGet-Process | Where-Object {$_.WorkingSet -gt 500MB} | \n    Select-Object Name, @{Name=\"Memory(MB)\";Expression={[math]::Round($_.WorkingSet/1MB,2)}}, Id\n\n# Procesos sin ruta (posible inyecci√≥n)\nGet-Process | Where-Object {$_.Path -eq \"\"} | Select-Object Name, Id\n\n# Procesos con nombres sospechosos\n$suspiciousNames = @(\"cmd\", \"powershell\", \"wscript\", \"cscript\", \"mshta\")\nGet-Process | Where-Object {$suspiciousNames -contains $_.Name} | \n    Select-Object Name, Id, Path, StartTime\n\n# Procesos hijos de procesos espec√≠ficos\nGet-Process -Name explorer | Get-Process | Select-Object Name, Id')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Procesos con alto uso de CPU
Get-Process | Where-Object {$_.CPU -gt 100} | 
    Select-Object Name, CPU, Id, Path | 
    Sort-Object CPU -Descending

# Procesos con alto uso de memoria
Get-Process | Where-Object {$_.WorkingSet -gt 500MB} | 
    Select-Object Name, @{Name="Memory(MB)";Expression={[math]::Round($_.WorkingSet/1MB,2)}}, Id

# Procesos sin ruta (posible inyecci√≥n)
Get-Process | Where-Object {$_.Path -eq ""} | Select-Object Name, Id

# Procesos con nombres sospechosos
$suspiciousNames = @("cmd", "powershell", "wscript", "cscript", "mshta")
Get-Process | Where-Object {$suspiciousNames -contains $_.Name} | 
    Select-Object Name, Id, Path, StartTime

# Procesos hijos de procesos espec√≠ficos
Get-Process -Name explorer | Get-Process | Select-Object Name, Id</code></pre>
                        </div>

                        <h3 id="archivos-sistema">An√°lisis de Archivos del Sistema</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Archivos modificados recientemente (√∫ltimas 24 horas)\nGet-ChildItem -Path C:\\Windows\\System32 -Recurse -ErrorAction SilentlyContinue | \n    Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-1)} | \n    Select-Object FullName, LastWriteTime, Length | \n    Sort-Object LastWriteTime -Descending\n\n# Archivos ejecutables en directorios temporales\n$tempDirs = @(\"$env:TEMP\", \"$env:LOCALAPPDATA\\Temp\", \"C:\\Windows\\Temp\")\nforeach ($dir in $tempDirs) {\n    Get-ChildItem -Path $dir -Filter *.exe -ErrorAction SilentlyContinue | \n        Select-Object FullName, LastWriteTime, Length\n}\n\n# Archivos con extensiones sospechosas\n$suspiciousExts = @(\".vbs\", \".js\", \".bat\", \".cmd\", \".scr\", \".pif\")\nGet-ChildItem -Path C:\\Users -Recurse -Include $suspiciousExts -ErrorAction SilentlyContinue | \n    Select-Object FullName, LastWriteTime\n\n# Hash SHA256 de archivo (para verificaci√≥n)\nGet-FileHash -Path \"C:\\path\\to\\file.exe\" -Algorithm SHA256')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Archivos modificados recientemente (√∫ltimas 24 horas)
Get-ChildItem -Path C:\Windows\System32 -Recurse -ErrorAction SilentlyContinue | 
    Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-1)} | 
    Select-Object FullName, LastWriteTime, Length | 
    Sort-Object LastWriteTime -Descending

# Archivos ejecutables en directorios temporales
$tempDirs = @("$env:TEMP", "$env:LOCALAPPDATA\Temp", "C:\Windows\Temp")
foreach ($dir in $tempDirs) {
    Get-ChildItem -Path $dir -Filter *.exe -ErrorAction SilentlyContinue | 
        Select-Object FullName, LastWriteTime, Length
}

# Archivos con extensiones sospechosas
$suspiciousExts = @(".vbs", ".js", ".bat", ".cmd", ".scr", ".pif")
Get-ChildItem -Path C:\Users -Recurse -Include $suspiciousExts -ErrorAction SilentlyContinue | 
    Select-Object FullName, LastWriteTime

# Hash SHA256 de archivo (para verificaci√≥n)
Get-FileHash -Path "C:\path\to\file.exe" -Algorithm SHA256</code></pre>
                        </div>

                        <h2 id="scripting-seguridad">Scripting para Seguridad</h2>

                        <h3 id="scripts-basicos">Scripts B√°sicos de Seguridad</h3>

                        <h4>Script: An√°lisis de Seguridad del Sistema</h4>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# security-audit.ps1\n# Script de auditor√≠a b√°sica de seguridad\n\nWrite-Host \"=== Auditor√≠a de Seguridad del Sistema ===\" -ForegroundColor Cyan\n\n# 1. Usuarios locales\nWrite-Host \"`n[+] Usuarios Locales:\" -ForegroundColor Yellow\nGet-LocalUser | Format-Table Name, Enabled, PasswordLastSet, PasswordNeverExpires\n\n# 2. Grupos administrativos\nWrite-Host \"`n[+] Miembros de Administradores:\" -ForegroundColor Yellow\nGet-LocalGroupMember -Group Administrators | Format-Table Name, PrincipalSource\n\n# 3. Servicios ejecut√°ndose\nWrite-Host \"`n[+] Servicios en Ejecuci√≥n:\" -ForegroundColor Yellow\nGet-Service | Where-Object Status -eq Running | \n    Select-Object Name, DisplayName, StartType | \n    Format-Table -AutoSize\n\n# 4. Puertos abiertos\nWrite-Host \"`n[+] Puertos Abiertos:\" -ForegroundColor Yellow\nGet-NetTCPConnection | Where-Object State -eq Listen | \n    Select-Object LocalAddress, LocalPort, OwningProcess | \n    Sort-Object LocalPort | Format-Table -AutoSize\n\n# 5. Procesos con alto uso de recursos\nWrite-Host \"`n[+] Procesos con Alto Uso de CPU:\" -ForegroundColor Yellow\nGet-Process | Sort-Object CPU -Descending | Select-Object -First 5 | \n    Format-Table Name, CPU, Id, Path\n\nWrite-Host \"`n[+] Auditor√≠a completada\" -ForegroundColor Green')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># security-audit.ps1
# Script de auditor√≠a b√°sica de seguridad

Write-Host "=== Auditor√≠a de Seguridad del Sistema ===" -ForegroundColor Cyan

# 1. Usuarios locales
Write-Host "`n[+] Usuarios Locales:" -ForegroundColor Yellow
Get-LocalUser | Format-Table Name, Enabled, PasswordLastSet, PasswordNeverExpires

# 2. Grupos administrativos
Write-Host "`n[+] Miembros de Administradores:" -ForegroundColor Yellow
Get-LocalGroupMember -Group Administrators | Format-Table Name, PrincipalSource

# 3. Servicios ejecut√°ndose
Write-Host "`n[+] Servicios en Ejecuci√≥n:" -ForegroundColor Yellow
Get-Service | Where-Object Status -eq Running | 
    Select-Object Name, DisplayName, StartType | 
    Format-Table -AutoSize

# 4. Puertos abiertos
Write-Host "`n[+] Puertos Abiertos:" -ForegroundColor Yellow
Get-NetTCPConnection | Where-Object State -eq Listen | 
    Select-Object LocalAddress, LocalPort, OwningProcess | 
    Sort-Object LocalPort | Format-Table -AutoSize

# 5. Procesos con alto uso de recursos
Write-Host "`n[+] Procesos con Alto Uso de CPU:" -ForegroundColor Yellow
Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 | 
    Format-Table Name, CPU, Id, Path

Write-Host "`n[+] Auditor√≠a completada" -ForegroundColor Green</code></pre>
                        </div>

                        <h4>Script: Detecci√≥n de Logons Sospechosos</h4>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# detect-suspicious-logons.ps1\n# Detectar logons sospechosos en las √∫ltimas 24 horas\n\n$hours = 24\n$startTime = (Get-Date).AddHours(-$hours)\n\nWrite-Host \"=== An√°lisis de Logons (√∫ltimas $hours horas) ===\" -ForegroundColor Cyan\n\n# Logons exitosos\n$logons = Get-WinEvent -FilterHashtable @{\n    LogName='Security'\n    ID=4624\n    StartTime=$startTime\n} -ErrorAction SilentlyContinue\n\nif ($logons) {\n    Write-Host \"`n[+] Logons Exitosos: $($logons.Count)\" -ForegroundColor Yellow\n    $logons | Select-Object TimeCreated, \n        @{Name='User';Expression={$_.Properties[5].Value}},\n        @{Name='SourceIP';Expression={$_.Properties[18].Value}},\n        @{Name='LogonType';Expression={$_.Properties[8].Value}} | \n        Format-Table -AutoSize\n    \n    # Logons desde IPs externas\n    $externalLogons = $logons | Where-Object {\n        $ip = $_.Properties[18].Value\n        $ip -and $ip -notmatch \"^127\\.|^::1|^192\\.168\\.|^10\\.|^172\\.(1[6-9]|2[0-9]|3[0-1])\\.\"\n    }\n    \n    if ($externalLogons) {\n        Write-Host \"`n[!] Logons desde IPs Externas: $($externalLogons.Count)\" -ForegroundColor Red\n        $externalLogons | Select-Object TimeCreated, \n            @{Name='User';Expression={$_.Properties[5].Value}},\n            @{Name='SourceIP';Expression={$_.Properties[18].Value}} | \n            Format-Table -AutoSize\n    }\n} else {\n    Write-Host \"[!] No se encontraron eventos de logon\" -ForegroundColor Yellow\n}\n\n# Logons fallidos\n$failedLogons = Get-WinEvent -FilterHashtable @{\n    LogName='Security'\n    ID=4625\n    StartTime=$startTime\n} -ErrorAction SilentlyContinue\n\nif ($failedLogons) {\n    Write-Host \"`n[!] Logons Fallidos: $($failedLogons.Count)\" -ForegroundColor Red\n    $failedLogons | Group-Object -Property {$_.Properties[5].Value} | \n        Sort-Object Count -Descending | \n        Select-Object @{Name='User';Expression={$_.Name}}, Count | \n        Format-Table -AutoSize\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># detect-suspicious-logons.ps1
# Detectar logons sospechosos en las √∫ltimas 24 horas

$hours = 24
$startTime = (Get-Date).AddHours(-$hours)

Write-Host "=== An√°lisis de Logons (√∫ltimas $hours horas) ===" -ForegroundColor Cyan

# Logons exitosos
$logons = Get-WinEvent -FilterHashtable @{
    LogName='Security'
    ID=4624
    StartTime=$startTime
} -ErrorAction SilentlyContinue

if ($logons) {
    Write-Host "`n[+] Logons Exitosos: $($logons.Count)" -ForegroundColor Yellow
    $logons | Select-Object TimeCreated, 
        @{Name='User';Expression={$_.Properties[5].Value}},
        @{Name='SourceIP';Expression={$_.Properties[18].Value}},
        @{Name='LogonType';Expression={$_.Properties[8].Value}} | 
        Format-Table -AutoSize
    
    # Logons desde IPs externas
    $externalLogons = $logons | Where-Object {
        $ip = $_.Properties[18].Value
        $ip -and $ip -notmatch "^127\.|^::1|^192\.168\.|^10\.|^172\.(1[6-9]|2[0-9]|3[0-1])\."
    }
    
    if ($externalLogons) {
        Write-Host "`n[!] Logons desde IPs Externas: $($externalLogons.Count)" -ForegroundColor Red
        $externalLogons | Select-Object TimeCreated, 
            @{Name='User';Expression={$_.Properties[5].Value}},
            @{Name='SourceIP';Expression={$_.Properties[18].Value}} | 
            Format-Table -AutoSize
    }
} else {
    Write-Host "[!] No se encontraron eventos de logon" -ForegroundColor Yellow
}

# Logons fallidos
$failedLogons = Get-WinEvent -FilterHashtable @{
    LogName='Security'
    ID=4625
    StartTime=$startTime
} -ErrorAction SilentlyContinue

if ($failedLogons) {
    Write-Host "`n[!] Logons Fallidos: $($failedLogons.Count)" -ForegroundColor Red
    $failedLogons | Group-Object -Property {$_.Properties[5].Value} | 
        Sort-Object Count -Descending | 
        Select-Object @{Name='User';Expression={$_.Name}}, Count | 
        Format-Table -AutoSize
}</code></pre>
                        </div>

                        <h3 id="automatizacion-tareas">Automatizaci√≥n de Tareas de Seguridad</h3>

                        <h4>Script: Monitoreo Continuo de Procesos</h4>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# monitor-processes.ps1\n# Monitoreo continuo de procesos sospechosos\n\n$interval = 60  # Segundos\n$logFile = \"C:\\Security\\process-monitor-$(Get-Date -Format 'yyyyMMdd-HHmmss').log\"\n\nfunction Monitor-Processes {\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \n    # Procesos nuevos desde √∫ltimo check\n    $currentProcesses = Get-Process | Select-Object -ExpandProperty Id\n    \n    # Procesos con nombres sospechosos\n    $suspicious = Get-Process | Where-Object {\n        $_.Name -match \"(cmd|powershell|wscript|cscript|mshta|rundll32)\" -and\n        $_.Path -notmatch \"Windows\\\\System32\"\n    }\n    \n    if ($suspicious) {\n        $alert = \"[$timestamp] ALERTA: Procesos sospechosos detectados`n\"\n        $alert += ($suspicious | Format-List | Out-String)\n        \n        Write-Host $alert -ForegroundColor Red\n        Add-Content -Path $logFile -Value $alert\n    }\n    \n    # Procesos con alto uso de CPU\n    $highCPU = Get-Process | Where-Object {$_.CPU -gt 100} | \n        Select-Object Name, CPU, Id, Path\n    \n    if ($highCPU) {\n        $info = \"[$timestamp] Procesos con alto CPU:`n\"\n        $info += ($highCPU | Format-Table | Out-String)\n        Add-Content -Path $logFile -Value $info\n    }\n}\n\nWrite-Host \"Iniciando monitoreo (intervalo: $interval segundos)\" -ForegroundColor Cyan\nWrite-Host \"Log: $logFile\" -ForegroundColor Cyan\n\nwhile ($true) {\n    Monitor-Processes\n    Start-Sleep -Seconds $interval\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># monitor-processes.ps1
# Monitoreo continuo de procesos sospechosos

$interval = 60  # Segundos
$logFile = "C:\Security\process-monitor-$(Get-Date -Format 'yyyyMMdd-HHmmss').log"

function Monitor-Processes {
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    
    # Procesos nuevos desde √∫ltimo check
    $currentProcesses = Get-Process | Select-Object -ExpandProperty Id
    
    # Procesos con nombres sospechosos
    $suspicious = Get-Process | Where-Object {
        $_.Name -match "(cmd|powershell|wscript|cscript|mshta|rundll32)" -and
        $_.Path -notmatch "Windows\\System32"
    }
    
    if ($suspicious) {
        $alert = "[$timestamp] ALERTA: Procesos sospechosos detectados`n"
        $alert += ($suspicious | Format-List | Out-String)
        
        Write-Host $alert -ForegroundColor Red
        Add-Content -Path $logFile -Value $alert
    }
    
    # Procesos con alto uso de CPU
    $highCPU = Get-Process | Where-Object {$_.CPU -gt 100} | 
        Select-Object Name, CPU, Id, Path
    
    if ($highCPU) {
        $info = "[$timestamp] Procesos con alto CPU:`n"
        $info += ($highCPU | Format-Table | Out-String)
        Add-Content -Path $logFile -Value $info
    }
}

Write-Host "Iniciando monitoreo (intervalo: $interval segundos)" -ForegroundColor Cyan
Write-Host "Log: $logFile" -ForegroundColor Cyan

while ($true) {
    Monitor-Processes
    Start-Sleep -Seconds $interval
}</code></pre>
                        </div>

                        <h2 id="hardening-powershell">Hardening de PowerShell</h2>

                        <h3 id="logging-powershell">Habilitar Logging de PowerShell</h3>
                        <p>El logging de PowerShell es cr√≠tico para detectar uso malicioso de PowerShell.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Habilitar Module Logging (registra todos los comandos ejecutados)\n# Requiere Group Policy o registro\n\n# V√≠a registro (requiere admin):\n$path = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging\"\nNew-Item -Path $path -Force | Out-Null\nSet-ItemProperty -Path $path -Name \"EnableModuleLogging\" -Value 1\n\n# Habilitar logging para m√≥dulos espec√≠ficos\n$modulePath = \"$path\\ModuleNames\"\nNew-Item -Path $modulePath -Force | Out-Null\nSet-ItemProperty -Path $modulePath -Name \"*\" -Value \"*\"\n\n# Habilitar Script Block Logging\n$scriptPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nNew-Item -Path $scriptPath -Force | Out-Null\nSet-ItemProperty -Path $scriptPath -Name \"EnableScriptBlockLogging\" -Value 1\n\n# Habilitar Transcription (registra toda la sesi√≥n)\n$transcriptPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\"\nNew-Item -Path $transcriptPath -Force | Out-Null\nSet-ItemProperty -Path $transcriptPath -Name \"EnableTranscripting\" -Value 1\nSet-ItemProperty -Path $transcriptPath -Name \"OutputDirectory\" -Value \"C:\\PowerShell\\Transcripts\"\n\n# Verificar configuraci√≥n\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\*\" | Format-List')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Habilitar Module Logging (registra todos los comandos ejecutados)
# Requiere Group Policy o registro

# V√≠a registro (requiere admin):
$path = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging"
New-Item -Path $path -Force | Out-Null
Set-ItemProperty -Path $path -Name "EnableModuleLogging" -Value 1

# Habilitar logging para m√≥dulos espec√≠ficos
$modulePath = "$path\ModuleNames"
New-Item -Path $modulePath -Force | Out-Null
Set-ItemProperty -Path $modulePath -Name "*" -Value "*"

# Habilitar Script Block Logging
$scriptPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging"
New-Item -Path $scriptPath -Force | Out-Null
Set-ItemProperty -Path $scriptPath -Name "EnableScriptBlockLogging" -Value 1

# Habilitar Transcription (registra toda la sesi√≥n)
$transcriptPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription"
New-Item -Path $transcriptPath -Force | Out-Null
Set-ItemProperty -Path $transcriptPath -Name "EnableTranscripting" -Value 1
Set-ItemProperty -Path $transcriptPath -Name "OutputDirectory" -Value "C:\PowerShell\Transcripts"

# Verificar configuraci√≥n
Get-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\*" | Format-List</code></pre>
                        </div>

                        <h3 id="constrained-language">Constrained Language Mode</h3>
                        <p>El modo de lenguaje restringido limita las capacidades de PowerShell para prevenir ejecuci√≥n de c√≥digo malicioso.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Verificar modo de lenguaje actual\n$ExecutionContext.SessionState.LanguageMode\n\n# Modos disponibles:\n# - FullLanguage: Sin restricciones (default)\n# - ConstrainedLanguage: Restricciones en .NET, COM, WMI\n# - NoLanguage: Solo cmdlets b√°sicos\n# - RestrictedLanguage: Muy limitado\n\n# Configurar Constrained Language Mode (requiere Group Policy)\n# Path: Computer Configuration > Administrative Templates > Windows Components > Windows PowerShell\n# Policy: Turn on Script Execution\n\n# Verificar si estamos en Constrained Mode\nif ($ExecutionContext.SessionState.LanguageMode -eq \"ConstrainedLanguage\") {\n    Write-Host \"PowerShell est√° en modo restringido\" -ForegroundColor Yellow\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Verificar modo de lenguaje actual
$ExecutionContext.SessionState.LanguageMode

# Modos disponibles:
# - FullLanguage: Sin restricciones (default)
# - ConstrainedLanguage: Restricciones en .NET, COM, WMI
# - NoLanguage: Solo cmdlets b√°sicos
# - RestrictedLanguage: Muy limitado

# Configurar Constrained Language Mode (requiere Group Policy)
# Path: Computer Configuration > Administrative Templates > Windows Components > Windows PowerShell
# Policy: Turn on Script Execution

# Verificar si estamos en Constrained Mode
if ($ExecutionContext.SessionState.LanguageMode -eq "ConstrainedLanguage") {
    Write-Host "PowerShell est√° en modo restringido" -ForegroundColor Yellow
}</code></pre>
                        </div>

                        <h2 id="modulos-seguridad">M√≥dulos de Seguridad √ötiles</h2>

                        <h3 id="instalacion-modulos">Instalaci√≥n de M√≥dulos</h3>
                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Instalar m√≥dulo desde PowerShell Gallery\nInstall-Module -Name ModuleName -Scope CurrentUser\n\n# M√≥dulos √∫tiles para seguridad:\n\n# 1. PSScriptAnalyzer (an√°lisis de c√≥digo)\nInstall-Module -Name PSScriptAnalyzer -Scope CurrentUser\n\n# 2. PSWindowsUpdate (gesti√≥n de actualizaciones)\nInstall-Module -Name PSWindowsUpdate -Scope CurrentUser\n\n# 3. SecurityPolicyDsc (configuraci√≥n de pol√≠ticas)\nInstall-Module -Name SecurityPolicyDsc -Scope CurrentUser\n\n# 4. ImportExcel (an√°lisis de datos)\nInstall-Module -Name ImportExcel -Scope CurrentUser\n\n# Listar m√≥dulos instalados\nGet-InstalledModule\n\n# Actualizar m√≥dulo\nUpdate-Module -Name ModuleName\n\n# Importar m√≥dulo\nImport-Module ModuleName')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Instalar m√≥dulo desde PowerShell Gallery
Install-Module -Name ModuleName -Scope CurrentUser

# M√≥dulos √∫tiles para seguridad:

# 1. PSScriptAnalyzer (an√°lisis de c√≥digo)
Install-Module -Name PSScriptAnalyzer -Scope CurrentUser

# 2. PSWindowsUpdate (gesti√≥n de actualizaciones)
Install-Module -Name PSWindowsUpdate -Scope CurrentUser

# 3. SecurityPolicyDsc (configuraci√≥n de pol√≠ticas)
Install-Module -Name SecurityPolicyDsc -Scope CurrentUser

# 4. ImportExcel (an√°lisis de datos)
Install-Module -Name ImportExcel -Scope CurrentUser

# Listar m√≥dulos instalados
Get-InstalledModule

# Actualizar m√≥dulo
Update-Module -Name ModuleName

# Importar m√≥dulo
Import-Module ModuleName</code></pre>
                        </div>

                        <h2 id="mejores-practicas">Mejores Pr√°cticas de Seguridad</h2>

                        <h3 id="script-security">Seguridad en Scripts</h3>
                        <ul>
                            <li><strong>Firmar scripts:</strong> Usar c√≥digo firmado para scripts en producci√≥n</li>
                            <li><strong>Validar entrada:</strong> Siempre validar y sanitizar entrada del usuario</li>
                            <li><strong>Principio de menor privilegio:</strong> Ejecutar scripts con permisos m√≠nimos necesarios</li>
                            <li><strong>Logging:</strong> Registrar acciones importantes en scripts</li>
                            <li><strong>Error handling:</strong> Manejar errores apropiadamente sin exponer informaci√≥n sensible</li>
                            <li><strong>Comentarios:</strong> Documentar c√≥digo para mantenibilidad</li>
                        </ul>

                        <h3 id="evitar-common-mistakes">Errores Comunes a Evitar</h3>
                        <ul>
                            <li>No usar <code>-ExecutionPolicy Bypass</code> en producci√≥n</li>
                            <li>No exponer credenciales en scripts (usar SecureString o credenciales encriptadas)</li>
                            <li>No ejecutar scripts desde ubicaciones no confiables sin revisar</li>
                            <li>No deshabilitar logging de PowerShell</li>
                            <li>No usar <code>Invoke-Expression</code> con entrada del usuario</li>
                        </ul>

                        <h2 id="recursos-adicionales">Recursos Adicionales</h2>
                        <ul>
                            <li><strong>Documentaci√≥n oficial:</strong> <a href="https://docs.microsoft.com/powershell" class="text-blue-600 dark:text-blue-400">Microsoft PowerShell Docs</a></li>
                            <li><strong>PowerShell Gallery:</strong> <a href="https://www.powershellgallery.com" class="text-blue-600 dark:text-blue-400">powershellgallery.com</a></li>
                            <li><strong>PowerShell Security:</strong> <a href="https://docs.microsoft.com/powershell/scripting/learn/remoting/security-considerations" class="text-blue-600 dark:text-blue-400">Security Considerations</a></li>
                            <li><strong>PowerShell Blog:</strong> <a href="https://devblogs.microsoft.com/powershell" class="text-blue-600 dark:text-blue-400">Microsoft PowerShell Blog</a></li>
                        </ul>

                        <div class="alert alert-success mt-8">
                            <p class="font-semibold mb-2">‚úÖ Conclusi√≥n</p>
                            <p>PowerShell es una herramienta poderosa para administraci√≥n Windows y seguridad. Dominar PowerShell te permite automatizar tareas, realizar forensics eficientemente y administrar sistemas Windows de manera profesional. Practica regularmente y construye un portfolio de scripts √∫tiles.</p>
                        </div>
                    </div>
                </article>
            </div>
        </main>
    </div>
        <footer class="bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-6">
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3">CyberSec Handbook</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                        Gu√≠a profesional y completa de ciberseguridad para profesionales de todos los niveles.
                    </p>
                    <p class="text-xs text-gray-500 dark:text-gray-500">
                        ¬© 2026 CyberSec Handbook. Todos los derechos reservados.
                    </p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3">Recursos</h3>
                    <ul class="space-y-2">
                        <li>
                            <a href="https://github.com/remiily/cybersec-handbook" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                                </svg>
                                GitHub
                            </a>
                        </li>
                        <li>
                            <a href="https://remiily.github.io/cybersec-handbook" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">
                                Sitio Web
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/remiily/cybersec-handbook/issues" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">
                                Reportar Issue
                            </a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3">Desarrollado por</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">
                        <a href="https://github.com/remiily" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">
                            @remiily
                        </a>
                    </p>
                    <p class="text-xs text-gray-500 dark:text-gray-500">
                        Recurso educativo de c√≥digo abierto bajo licencia MIT
                    </p>
                </div>
            </div>
            <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                <p class="text-xs text-center text-gray-500 dark:text-gray-500">
                    Este handbook es un recurso educativo. Las t√©cnicas y herramientas descritas deben usarse √∫nicamente en entornos autorizados y de acuerdo con las leyes aplicables.
                </p>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/navigation.js"></script>
    <script src="../../assets/js/search.js"></script>
    <script src="../../assets/js/main.js"></script>
    <style>[x-cloak] { display: none !important; }</style>
    <script>
        (function() {
            function initNav() {
                if (typeof initNavigation === 'function') {
                    initNavigation();
                } else if (typeof generateNavigation === 'function') {
                    const sidebar = document.querySelector('.sidebar nav');
                    if (sidebar) {
                        sidebar.innerHTML = generateNavigation();
                        if (typeof highlightCurrentPage === 'function') {
                            highlightCurrentPage();
                        }
                    }
                }
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(initNav, 200);
                });
            } else {
                setTimeout(initNav, 200);
            }
        })();
    </script>
</body>
</html>