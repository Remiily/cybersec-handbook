<!DOCTYPE html>
<html lang="es" x-data="app" x-init="init()" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go para Ciberseguridad - CyberSec Handbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>tailwind.config = { darkMode: 'class' }</script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <header class="sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-4">
                    <button @click="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden sidebar-toggle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <a href="../../index.html" class="flex items-center gap-2">
                        <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">üõ°Ô∏è CyberSec Handbook</h1>
                    </a>
                </div>
                <button @click="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                    <svg x-show="!darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                    <svg x-show="darkMode" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    <div x-show="sidebarOpen" @click="closeSidebar()" class="sidebar-overlay" x-cloak></div>
    <div class="flex relative">
        <aside :class="sidebarOpen ? 'open' : ''" class="sidebar">
            <nav class="p-4 space-y-2">
                <!-- Navigation will be generated by navigation.js -->
            </nav>
        </aside>
        <main class="flex-1 min-h-screen lg:ml-64">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <article>
                    <header class="mb-8">
                        <h1 class="text-4xl font-bold mb-4">Go para Ciberseguridad</h1>
                        <p class="text-xl text-gray-600 dark:text-gray-400 mb-4">Gu√≠a completa de seguridad en Go: vulnerabilidades comunes, herramientas y mejores pr√°cticas</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="badge badge-intermediate">Nivel: Intermedio</span>
                            <span class="badge">üêπ Go 1.20+</span>
                            <span class="badge">üîí Secure Coding</span>
                        </div>
                    </header>
                    <div id="table-of-contents" class="toc"></div>
                    <div class="prose prose-lg dark:prose-invert max-w-none">
                        <h2 id="introduccion">Introducci√≥n</h2>
                        <p>Go es un lenguaje dise√±ado con seguridad en mente, pero a√∫n as√≠ requiere atenci√≥n a las mejores pr√°cticas. Esta gu√≠a cubre vulnerabilidades comunes, herramientas de seguridad y patrones seguros para desarrollo en Go.</p>

                        <div class="alert alert-info mb-6">
                            <p class="font-semibold mb-2">üí° Caracter√≠sticas de Seguridad de Go</p>
                            <p>Go incluye caracter√≠sticas de seguridad integradas como memory safety, type safety, y gesti√≥n autom√°tica de memoria. Sin embargo, a√∫n es posible introducir vulnerabilidades si no se siguen las mejores pr√°cticas.</p>
                        </div>

                        <h2 id="vulnerabilidades-comunes">Vulnerabilidades Comunes en Go</h2>

                        <h3 id="command-injection">Command Injection</h3>
                        <p>La inyecci√≥n de comandos ocurre cuando se ejecutan comandos del sistema con input del usuario sin validaci√≥n adecuada.</p>

                        <div class="alert alert-warning mb-4">
                            <p><strong>‚ö†Ô∏è NUNCA uses os/exec con input del usuario directamente:</strong></p>
                            <div class="command-block mb-4" x-data="copyCommand">
                                <button @click="copy('package main\n\nimport (\n\t\"os/exec\"\n\t\"fmt\"\n)\n\n// MAL - Vulnerable a command injection\nfunc vulnerableCommand(userInput string) error {\n\tcmd := exec.Command(\"sh\", \"-c\", userInput)\n\treturn cmd.Run()\n}\n\n// BIEN - Usar argumentos separados\nfunc safeCommand(userInput string) error {\n\t// userInput se trata como argumento, no como comando\n\tcmd := exec.Command(\"ls\", \"-l\", userInput)\n\treturn cmd.Run()\n}\n\n// MEJOR - Validar input antes de usar\nfunc validatedCommand(userInput string) error {\n\t// Validar que solo contiene caracteres permitidos\n\tif !isValidFilename(userInput) {\n\t\treturn fmt.Errorf(\"invalid input\")\n\t}\n\tcmd := exec.Command(\"ls\", \"-l\", userInput)\n\treturn cmd.Run()\n}\n\nfunc isValidFilename(s string) bool {\n\t// Solo permitir letras, n√∫meros, guiones y puntos\n\tfor _, r := range s {\n\t\tif !((r >= \'a\' && r <= \'z\') || (r >= \'A\' && r <= \'Z\') ||\n\t\t\t (r >= \'0\' && r <= \'9\') || r == \'-\' || r == \'.\') {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                    <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                    <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </button>
                                <pre><code>package main

import (
	"os/exec"
	"fmt"
)

// MAL - Vulnerable a command injection
func vulnerableCommand(userInput string) error {
	cmd := exec.Command("sh", "-c", userInput)
	return cmd.Run()
}

// BIEN - Usar argumentos separados
func safeCommand(userInput string) error {
	// userInput se trata como argumento, no como comando
	cmd := exec.Command("ls", "-l", userInput)
	return cmd.Run()
}

// MEJOR - Validar input antes de usar
func validatedCommand(userInput string) error {
	// Validar que solo contiene caracteres permitidos
	if !isValidFilename(userInput) {
		return fmt.Errorf("invalid input")
	}
	cmd := exec.Command("ls", "-l", userInput)
	return cmd.Run()
}

func isValidFilename(s string) bool {
	// Solo permitir letras, n√∫meros, guiones y puntos
	for _, r := range s {
		if !((r >= 'a' && r <= 'z') || (r >= 'A' && r <= 'Z') ||
			 (r >= '0' && r <= '9') || r == '-' || r == '.') {
			return false
		}
	}
	return true
}</code></pre>
                            </div>
                        </div>

                        <h3 id="path-traversal">Path Traversal</h3>
                        <p>Path traversal permite acceder a archivos fuera del directorio permitido usando secuencias como <code>../</code>.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('package main\n\nimport (\n\t\"fmt\"\n\t\"path/filepath\"\n\t\"strings\"\n)\n\n// BIEN - Validar paths\na func safeJoin(base, userPath string) (string, error) {\n\t// Limpiar path\n\tcleanPath := filepath.Clean(userPath)\n\t\n\t// Prevenir path traversal\n\tif strings.Contains(cleanPath, \"..\") {\n\t\treturn \"\", fmt.Errorf(\"invalid path\")\n\t}\n\t\n\t// Construir path absoluto\n\tfullPath := filepath.Join(base, cleanPath)\n\t\n\t// Verificar que est√° dentro del directorio base\n\trel, err := filepath.Rel(base, fullPath)\n\tif err != nil || strings.HasPrefix(rel, \"..\") {\n\t\treturn \"\", fmt.Errorf(\"path outside base directory\")\n\t}\n\t\n\treturn fullPath, nil\n}\n\n// Alternativa usando filepath.Abs\nfunc safeJoinAbs(base, userPath string) (string, error) {\n\tbaseAbs, err := filepath.Abs(base)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\t\n\tfullPath := filepath.Join(baseAbs, userPath)\n\tfullPathAbs, err := filepath.Abs(fullPath)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\t\n\t// Verificar que el path resultante est√° dentro de base\n\tif !strings.HasPrefix(fullPathAbs, baseAbs) {\n\t\treturn \"\", fmt.Errorf(\"path outside base directory\")\n\t}\n\t\n\treturn fullPathAbs, nil\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>package main

import (
	"fmt"
	"path/filepath"
	"strings"
)

// BIEN - Validar paths
func safeJoin(base, userPath string) (string, error) {
	// Limpiar path
	cleanPath := filepath.Clean(userPath)
	
	// Prevenir path traversal
	if strings.Contains(cleanPath, "..") {
		return "", fmt.Errorf("invalid path")
	}
	
	// Construir path absoluto
	fullPath := filepath.Join(base, cleanPath)
	
	// Verificar que est√° dentro del directorio base
	rel, err := filepath.Rel(base, fullPath)
	if err != nil || strings.HasPrefix(rel, "..") {
		return "", fmt.Errorf("path outside base directory")
	}
	
	return fullPath, nil
}

// Alternativa usando filepath.Abs
func safeJoinAbs(base, userPath string) (string, error) {
	baseAbs, err := filepath.Abs(base)
	if err != nil {
		return "", err
	}
	
	fullPath := filepath.Join(baseAbs, userPath)
	fullPathAbs, err := filepath.Abs(fullPath)
	if err != nil {
		return "", err
	}
	
	// Verificar que el path resultante est√° dentro de base
	if !strings.HasPrefix(fullPathAbs, baseAbs) {
		return "", fmt.Errorf("path outside base directory")
	}
	
	return fullPathAbs, nil
}</code></pre>
                        </div>

                        <h3 id="sql-injection">SQL Injection</h3>
                        <p>Aunque Go tiene protecci√≥n contra SQL injection con prepared statements, es importante usarlos correctamente.</p>

                        <div class="alert alert-warning mb-4">
                            <p><strong>‚ö†Ô∏è NUNCA construyas queries SQL con concatenaci√≥n de strings:</strong></p>
                            <div class="command-block mb-4" x-data="copyCommand">
                                <button @click="copy('package main\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n\t_ \"github.com/go-sql-driver/mysql\"\n)\n\n// MAL - Vulnerable a SQL Injection\nfunc vulnerableQuery(db *sql.DB, userID string) error {\n\tquery := fmt.Sprintf(\"SELECT * FROM users WHERE id = %s\", userID)\n\trows, err := db.Query(query)\n\t// ...\n}\n\n// BIEN - Usar prepared statements\nfunc safeQuery(db *sql.DB, userID string) error {\n\tquery := \"SELECT * FROM users WHERE id = ?\"\n\trows, err := db.Query(query, userID)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer rows.Close()\n\t// ...\n}\n\n// MEJOR - Usar prepared statements con contexto\nfunc safeQueryWithContext(db *sql.DB, ctx context.Context, userID string) error {\n\tquery := \"SELECT * FROM users WHERE id = ?\"\n\tstmt, err := db.PrepareContext(ctx, query)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer stmt.Close()\n\t\n\trows, err := stmt.QueryContext(ctx, userID)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer rows.Close()\n\t// ...\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                    <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                    <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </button>
                                <pre><code>package main

import (
	"database/sql"
	"fmt"
	_ "github.com/go-sql-driver/mysql"
)

// MAL - Vulnerable a SQL Injection
func vulnerableQuery(db *sql.DB, userID string) error {
	query := fmt.Sprintf("SELECT * FROM users WHERE id = %s", userID)
	rows, err := db.Query(query)
	// ...
}

// BIEN - Usar prepared statements
func safeQuery(db *sql.DB, userID string) error {
	query := "SELECT * FROM users WHERE id = ?"
	rows, err := db.Query(query, userID)
	if err != nil {
		return err
	}
	defer rows.Close()
	// ...
}

// MEJOR - Usar prepared statements con contexto
func safeQueryWithContext(db *sql.DB, ctx context.Context, userID string) error {
	query := "SELECT * FROM users WHERE id = ?"
	stmt, err := db.PrepareContext(ctx, query)
	if err != nil {
		return err
	}
	defer stmt.Close()
	
	rows, err := stmt.QueryContext(ctx, userID)
	if err != nil {
		return err
	}
	defer rows.Close()
	// ...
}</code></pre>
                            </div>
                        </div>

                        <h3 id="crypto-weak">Criptograf√≠a D√©bil</h3>
                        <p>Go proporciona excelentes librer√≠as criptogr√°ficas, pero es importante usarlas correctamente.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('package main\n\nimport (\n\t\"crypto/rand\"\n\t\"crypto/subtle\"\n\t\"golang.org/x/crypto/bcrypt\"\n\t\"golang.org/x/crypto/argon2\"\n)\n\n// Hash de passwords con bcrypt\nfunc hashPassword(password string) (string, error) {\n\tbytes, err := bcrypt.GenerateFromPassword([]byte(password), bcrypt.DefaultCost)\n\treturn string(bytes), err\n}\n\nfunc checkPassword(password, hash string) bool {\n\terr := bcrypt.CompareHashAndPassword([]byte(hash), []byte(password))\n\treturn err == nil\n}\n\n// Hash con Argon2 (m√°s moderno)\nfunc hashPasswordArgon2(password string) (string, error) {\n\tsalt := make([]byte, 16)\n\tif _, err := rand.Read(salt); err != nil {\n\t\treturn \"\", err\n\t}\n\t\n\thash := argon2.IDKey([]byte(password), salt, 1, 64*1024, 4, 32)\n\treturn fmt.Sprintf(\"%x:%x\", salt, hash), nil\n}\n\n// Comparaci√≥n segura de strings (prevenir timing attacks)\nfunc secureCompare(a, b string) bool {\n\treturn subtle.ConstantTimeCompare([]byte(a), []byte(b)) == 1\n}\n\n// Generar tokens seguros\nfunc generateSecureToken() (string, error) {\n\tb := make([]byte, 32)\n\tif _, err := rand.Read(b); err != nil {\n\t\treturn \"\", err\n\t}\n\treturn hex.EncodeToString(b), nil\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>package main

import (
	"crypto/rand"
	"crypto/subtle"
	"golang.org/x/crypto/bcrypt"
	"golang.org/x/crypto/argon2"
)

// Hash de passwords con bcrypt
func hashPassword(password string) (string, error) {
	bytes, err := bcrypt.GenerateFromPassword([]byte(password), bcrypt.DefaultCost)
	return string(bytes), err
}

func checkPassword(password, hash string) bool {
	err := bcrypt.CompareHashAndPassword([]byte(hash), []byte(password))
	return err == nil
}

// Hash con Argon2 (m√°s moderno)
func hashPasswordArgon2(password string) (string, error) {
	salt := make([]byte, 16)
	if _, err := rand.Read(salt); err != nil {
		return "", err
	}
	
	hash := argon2.IDKey([]byte(password), salt, 1, 64*1024, 4, 32)
	return fmt.Sprintf("%x:%x", salt, hash), nil
}

// Comparaci√≥n segura de strings (prevenir timing attacks)
func secureCompare(a, b string) bool {
	return subtle.ConstantTimeCompare([]byte(a), []byte(b)) == 1
}

// Generar tokens seguros
func generateSecureToken() (string, error) {
	b := make([]byte, 32)
	if _, err := rand.Read(b); err != nil {
		return "", err
	}
	return hex.EncodeToString(b), nil
}</code></pre>
                        </div>

                        <h3 id="deserialization">Deserializaci√≥n Insegura</h3>
                        <p>La deserializaci√≥n de datos no confiables puede llevar a ejecuci√≥n de c√≥digo arbitrario.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('package main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n)\n\n// BIEN - Validar datos deserializados\ntype User struct {\n\tID    int    `json:\"id\"`\n\tName  string `json:\"name\"`\n\tEmail string `json:\"email\"`\n}\n\nfunc safeDeserialize(data []byte) (*User, error) {\n\tvar user User\n\tif err := json.Unmarshal(data, &user); err != nil {\n\t\treturn nil, err\n\t}\n\t\n\t// Validar datos\n\tif user.ID <= 0 {\n\t\treturn nil, fmt.Errorf(\"invalid user ID\")\n\t}\n\tif !isValidEmail(user.Email) {\n\t\treturn nil, fmt.Errorf(\"invalid email\")\n\t}\n\t\n\treturn &user, nil\n}\n\n// NUNCA usar gob.Decode con datos no confiables\n// gob puede ejecutar c√≥digo arbitrario durante la deserializaci√≥n')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>package main

import (
	"encoding/json"
	"fmt"
)

// BIEN - Validar datos deserializados
type User struct {
	ID    int    `json:"id"`
	Name  string `json:"name"`
	Email string `json:"email"`
}

func safeDeserialize(data []byte) (*User, error) {
	var user User
	if err := json.Unmarshal(data, &user); err != nil {
		return nil, err
	}
	
	// Validar datos
	if user.ID <= 0 {
		return nil, fmt.Errorf("invalid user ID")
	}
	if !isValidEmail(user.Email) {
		return nil, fmt.Errorf("invalid email")
	}
	
	return &user, nil
}

// NUNCA usar gob.Decode con datos no confiables
// gob puede ejecutar c√≥digo arbitrario durante la deserializaci√≥n</code></pre>
                        </div>

                        <h2 id="herramientas-seguridad">Herramientas de Seguridad</h2>

                        <h3 id="gosec">Gosec - Security Scanner</h3>
                        <p>Gosec escanea c√≥digo Go en busca de problemas de seguridad comunes.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Instalar Gosec\ngo install github.com/securego/gosec/v2/cmd/gosec@latest\n\n# Ejecutar en el directorio del proyecto\ngosec ./...\n\n# Con output JSON\ngosec -fmt json -out results.json ./...\n\n# Con output SARIF (para GitHub)\ngosec -fmt sarif -out results.sarif ./...\n\n# Solo mostrar problemas de alta severidad\ngosec -severity high ./...\n\n# Excluir reglas espec√≠ficas\ngosec -exclude=G101,G102 ./...\n\n# Integrar en CI/CD\n# .github/workflows/security.yml\ngosec -fmt json -out gosec-report.json ./...')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Instalar Gosec
go install github.com/securego/gosec/v2/cmd/gosec@latest

# Ejecutar en el directorio del proyecto
gosec ./...

# Con output JSON
gosec -fmt json -out results.json ./...

# Con output SARIF (para GitHub)
gosec -fmt sarif -out results.sarif ./...

# Solo mostrar problemas de alta severidad
gosec -severity high ./...

# Excluir reglas espec√≠ficas
gosec -exclude=G101,G102 ./...

# Integrar en CI/CD
# .github/workflows/security.yml
gosec -fmt json -out gosec-report.json ./...</code></pre>
                        </div>

                        <h3 id="govulncheck">Govulncheck - Vulnerability Checker</h3>
                        <p>Herramienta oficial de Go para verificar vulnerabilidades conocidas en dependencias.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Instalar govulncheck\ngo install golang.org/x/vuln/cmd/govulncheck@latest\n\n# Ejecutar en el proyecto\ngovulncheck ./...\n\n# Verificar solo vulnerabilidades de alta severidad\ngovulncheck -severity high ./...\n\n# Verificar con contexto (muestra solo vulnerabilidades explotables)\ngovulncheck -mode=binary ./...\n\n# Integrar en CI/CD\ngovulncheck ./... || exit 1')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Instalar govulncheck
go install golang.org/x/vuln/cmd/govulncheck@latest

# Ejecutar en el proyecto
govulncheck ./...

# Verificar solo vulnerabilidades de alta severidad
govulncheck -severity high ./...

# Verificar con contexto (muestra solo vulnerabilidades explotables)
govulncheck -mode=binary ./...

# Integrar en CI/CD
govulncheck ./... || exit 1</code></pre>
                        </div>

                        <h3 id="staticcheck">Staticcheck - Static Analysis</h3>
                        <p>Staticcheck es un conjunto de herramientas de an√°lisis est√°tico para Go.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('# Instalar staticcheck\ngo install honnef.co/go/tools/cmd/staticcheck@latest\n\n# Ejecutar\nstaticcheck ./...\n\n# Con configuraci√≥n espec√≠fica\n# .staticcheck.conf\nchecks = [\"all\", \"-SA1019\"]\n\n# Integrar en CI/CD\nstaticcheck -checks all ./...')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code># Instalar staticcheck
go install honnef.co/go/tools/cmd/staticcheck@latest

# Ejecutar
staticcheck ./...

# Con configuraci√≥n espec√≠fica
# .staticcheck.conf
checks = ["all", "-SA1019"]

# Integrar en CI/CD
staticcheck -checks all ./...</code></pre>
                        </div>

                        <h2 id="mejores-practicas">Mejores Pr√°cticas de Seguridad</h2>

                        <h3 id="input-validation">Validaci√≥n de Input</h3>
                        <p>Siempre valida y sanitiza el input del usuario antes de procesarlo.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('package main\n\nimport (\n\t\"fmt\"\n\t\"regexp\"\n\t\"strings\"\n)\n\n// Validaci√≥n de email\nfunc isValidEmail(email string) bool {\n\temailRegex := regexp.MustCompile(`^[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}$`)\n\treturn emailRegex.MatchString(email)\n}\n\n// Validaci√≥n de URL\nfunc isValidURL(url string) bool {\n\turlRegex := regexp.MustCompile(`^https?://[a-zA-Z0-9.\\-]+(?:/[^\\s]*)?$`)\n\treturn urlRegex.MatchString(url)\n}\n\n// Sanitizaci√≥n de input\nfunc sanitizeInput(input string) string {\n\t// Remover caracteres peligrosos\n\tinput = strings.TrimSpace(input)\n\tinput = strings.ReplaceAll(input, \"<\", \"&lt;\")\n\tinput = strings.ReplaceAll(input, \">\", \"&gt;\")\n\tinput = strings.ReplaceAll(input, \"\\\"\", \"&quot;\")\n\tinput = strings.ReplaceAll(input, \"\'\", \"&#39;\")\n\treturn input\n}\n\n// Validaci√≥n de longitud\nfunc validateLength(s string, min, max int) error {\n\tif len(s) < min || len(s) > max {\n\t\treturn fmt.Errorf(\"length must be between %d and %d\", min, max)\n\t}\n\treturn nil\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>package main

import (
	"fmt"
	"regexp"
	"strings"
)

// Validaci√≥n de email
func isValidEmail(email string) bool {
	emailRegex := regexp.MustCompile(`^[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}$`)
	return emailRegex.MatchString(email)
}

// Validaci√≥n de URL
func isValidURL(url string) bool {
	urlRegex := regexp.MustCompile(`^https?://[a-zA-Z0-9.\-]+(?:/[^\s]*)?$`)
	return urlRegex.MatchString(url)
}

// Sanitizaci√≥n de input
func sanitizeInput(input string) string {
	// Remover caracteres peligrosos
	input = strings.TrimSpace(input)
	input = strings.ReplaceAll(input, "<", "&lt;")
	input = strings.ReplaceAll(input, ">", "&gt;")
	input = strings.ReplaceAll(input, "\"", "&quot;")
	input = strings.ReplaceAll(input, "'", "&#39;")
	return input
}

// Validaci√≥n de longitud
func validateLength(s string, min, max int) error {
	if len(s) < min || len(s) > max {
		return fmt.Errorf("length must be between %d and %d", min, max)
	}
	return nil
}</code></pre>
                        </div>

                        <h3 id="error-handling">Manejo Seguro de Errores</h3>
                        <p>Los mensajes de error no deben exponer informaci√≥n sensible sobre el sistema.</p>

                        <div class="command-block mb-4" x-data="copyCommand">
                            <button @click="copy('package main\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"log\"\n)\n\n// MAL - Exponer informaci√≥n sensible\nfunc badErrorHandling(err error) error {\n\treturn fmt.Errorf(\"database error: %v\", err)\n\t// Puede exponer estructura de BD, queries, etc.\n}\n\n// BIEN - Mensajes de error gen√©ricos para usuarios\nfunc safeErrorHandling(err error) error {\n\tlog.Printf(\"Internal error: %v\", err)  // Log interno\n\treturn errors.New(\"an error occurred. Please try again later\")\n}\n\n// Mejor - Diferentes niveles de detalle\nfunc handleError(err error, userFacing bool) error {\n\tif userFacing {\n\t\t// Mensaje gen√©rico para usuarios\n\t\treturn errors.New(\"operation failed\")\n\t} else {\n\t\t// Detalle completo para logs internos\n\t\tlog.Printf(\"Error details: %+v\", err)\n\t\treturn err\n\t}\n}')" class="copy-btn" :class="{ 'copied': copied }">
                                <svg x-show="!copied" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg x-show="copied" class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-cloak>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                            <pre><code>package main

import (
	"errors"
	"fmt"
	"log"
)

// MAL - Exponer informaci√≥n sensible
func badErrorHandling(err error) error {
	return fmt.Errorf("database error: %v", err)
	// Puede exponer estructura de BD, queries, etc.
}

// BIEN - Mensajes de error gen√©ricos para usuarios
func safeErrorHandling(err error) error {
	log.Printf("Internal error: %v", err)  // Log interno
	return errors.New("an error occurred. Please try again later")
}

// Mejor - Diferentes niveles de detalle
func handleError(err error, userFacing bool) error {
	if userFacing {
		// Mensaje gen√©rico para usuarios
		return errors.New("operation failed")
	} else {
		// Detalle completo para logs internos
		log.Printf("Error details: %+v", err)
		return err
	}
}</code></pre>
                        </div>

                        <h3 id="checklist-seguridad">Checklist de Seguridad Go</h3>
                        <div class="checklist-container mb-6">
                            <div class="checklist" data-checklist-id="go-security">
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 0)" class="checklist-checkbox">
                                        <span>Nunca usar os/exec con input del usuario sin validaci√≥n</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 1)" class="checklist-checkbox">
                                        <span>Validar paths para prevenir path traversal</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 2)" class="checklist-checkbox">
                                        <span>Usar prepared statements para todas las queries SQL</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 3)" class="checklist-checkbox">
                                        <span>Usar crypto/rand para generar valores aleatorios seguros</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 4)" class="checklist-checkbox">
                                        <span>Validar y sanitizar todo el input del usuario</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 5)" class="checklist-checkbox">
                                        <span>Usar gosec y govulncheck regularmente</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 6)" class="checklist-checkbox">
                                        <span>No exponer informaci√≥n sensible en mensajes de error</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 7)" class="checklist-checkbox">
                                        <span>Usar context.Context para timeouts y cancelaci√≥n</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 8)" class="checklist-checkbox">
                                        <span>Mantener dependencias actualizadas (go get -u)</span>
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" onchange="handleChecklistChange('go-security', 9)" class="checklist-checkbox">
                                        <span>Usar HTTPS en producci√≥n</span>
                                    </label>
                                </div>
                            </div>
                            <div class="checklist-progress mt-4">
                                <div class="progress-bar">
                                    <div class="progress-fill" data-progress="go-security"></div>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Progreso: <span data-progress-text="go-security">0%</span></p>
                            </div>
                        </div>

                        <h2 id="recursos-adicionales">Recursos Adicionales</h2>
                        <ul>
                            <li><strong>Go Security:</strong> <a href="https://go.dev/doc/security/best-practices" class="text-blue-600 dark:text-blue-400">go.dev security best practices</a></li>
                            <li><strong>Gosec:</strong> <a href="https://github.com/securego/gosec" class="text-blue-600 dark:text-blue-400">github.com/securego/gosec</a></li>
                            <li><strong>Govulncheck:</strong> <a href="https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck" class="text-blue-600 dark:text-blue-400">golang.org/x/vuln</a></li>
                            <li><strong>Go Cryptography:</strong> <a href="https://pkg.go.dev/crypto" class="text-blue-600 dark:text-blue-400">crypto package</a></li>
                        </ul>

                        <div class="alert alert-success mt-8">
                            <p class="font-semibold mb-2">‚úÖ Conclusi√≥n</p>
                            <p>Go tiene excelente soporte para seguridad. Usa las herramientas oficiales como govulncheck y gosec para escanear c√≥digo. Recuerda validar siempre el input del usuario, usar prepared statements para SQL, y seguir las mejores pr√°cticas de criptograf√≠a. Mant√©n tus dependencias actualizadas y escanea regularmente tu c√≥digo.</p>
                        </div>
                    </div>
                </article>
            </div>
        </main>
    </div>
    <footer class="bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-sm text-gray-600 dark:text-gray-400">¬© 2026 CyberSec Handbook. Todos los derechos reservados.</p>
                <a href="https://github.com/remiily/cybersec-handbook" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">Editar en GitHub</a>
            </div>
        </div>
    </footer>

    <script src="../../assets/js/navigation.js"></script>
    <script src="../../assets/js/search.js"></script>
    <script src="../../assets/js/main.js"></script>
    <style>[x-cloak] { display: none !important; }</style>
    <script>
        (function() {
            function initNav() {
                if (typeof initNavigation === 'function') {
                    initNavigation();
                } else if (typeof generateNavigation === 'function') {
                    const sidebar = document.querySelector('.sidebar nav');
                    if (sidebar) {
                        sidebar.innerHTML = generateNavigation();
                        if (typeof highlightCurrentPage === 'function') {
                            highlightCurrentPage();
                        }
                    }
                }
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(initNav, 200);
                });
            } else {
                setTimeout(initNav, 200);
            }
        })();
    </script>
</body>
</html>